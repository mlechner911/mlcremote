const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PdfPreview-Dz2bbC-Y.js","./vendor-react-DgaSUS5F.js","./vendor-scheduler-DYLXRpC5.js","./vendor-prism-D73ALYcd.js","./vendor-prism-Cg1sXqY3.css","./vendor-html2canvas-BfYXEYrK.js","./vendor-xterm-DOcMqDAd.js","./vendor-xterm-DYP7pi_n.css","./vendor-i18next-BnqEsHlA.js","./vendor-i18next-browser-languagedetector-ClvlpAgo.js","./ShellView-CLbCGdhl.js","./TerminalTab-2J0oe7jc.js"])))=>i.map(i=>d[i]);
var kt=Object.defineProperty;var St=(t,n,s)=>n in t?kt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s;var ot=(t,n,s)=>St(t,typeof n!="symbol"?n+"":n,s);import{r as K,R as o,j as e,u as ne,i as Ct,c as Lt}from"./vendor-react-DgaSUS5F.js";import{P as Ue}from"./vendor-prism-D73ALYcd.js";import{h as Et}from"./vendor-html2canvas-BfYXEYrK.js";import"./vendor-xterm-DOcMqDAd.js";import{i as Nt}from"./vendor-i18next-BnqEsHlA.js";import{B as Tt}from"./vendor-i18next-browser-languagedetector-ClvlpAgo.js";import"./vendor-scheduler-DYLXRpC5.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const h of a)if(h.type==="childList")for(const l of h.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const h={};return a.integrity&&(h.integrity=a.integrity),a.referrerPolicy&&(h.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?h.credentials="include":a.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function r(a){if(a.ep)return;a.ep=!0;const h=s(a);fetch(a.href,h)}})();const Rt="modulepreload",zt=function(t,n){return new URL(t,n).href},rt={},Re=function(n,s,r){let a=Promise.resolve();if(s&&s.length>0){const l=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),u=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=Promise.allSettled(s.map(f=>{if(f=zt(f,r),f in rt)return;rt[f]=!0;const v=f.endsWith(".css"),k=v?'[rel="stylesheet"]':"";if(!!r)for(let _=l.length-1;_>=0;_--){const j=l[_];if(j.href===f&&(!v||j.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${k}`))return;const x=document.createElement("link");if(x.rel=v?"stylesheet":Rt,v||(x.as="script"),x.crossOrigin="",x.href=f,u&&x.setAttribute("nonce",u),document.head.appendChild(x),v)return new Promise((_,j)=>{x.addEventListener("load",_),x.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${f}`)))})}))}function h(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&h(c.reason);return n().catch(h)})},Dt=200,Se=[],Ce=[];function at(t,n){const s={ts:new Date().toISOString(),level:t,msg:n};for(Se.push(s);Se.length>Dt;)Se.shift();Ce.forEach(r=>r())}function J(t){at("info",t)}function Le(t){at("warn",t)}function It(){return Se.slice().reverse()}function Mt(t){return Ce.push(t),()=>{const n=Ce.indexOf(t);n>=0&&Ce.splice(n,1)}}function Pt(){Se.length=0,Ce.forEach(t=>t())}function Ve(){try{return localStorage.getItem("mlcremote_token")}catch{return null}}function lt(t){try{localStorage.setItem("mlcremote_token",t)}catch{}}let we="";function Ft(t){we=t.replace(/\/$/,"")}function cl(){return we}function Ee(t){if(!we||typeof t!="string"||t.startsWith("http"))return t;if(we.includes("?")){const[n,s]=we.split("?"),r=`${n.replace(/\/$/,"")}${t}`;return r.includes("?")?`${r}&${s}`:`${r}?${s}`}return`${we}${t}`}async function ae(t,n){const s=Ve(),r=new Headers(n==null?void 0:n.headers);s&&r.set("X-Auth-Token",s);const a={...n||{},headers:r};let h=t;typeof t=="string"&&t.startsWith("/")&&(h=Ee(t));const l=await fetch(h,a);if(l.status===401){try{localStorage.removeItem("mlcremote_token")}catch{}try{window.dispatchEvent(new CustomEvent("mlcremote:auth-failed",{detail:{url:typeof t=="string"?t:t.url}}))}catch{}}return l}async function Ot(t){J("POST /api/login");const n=await fetch(Ee("/api/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t})});if(J(`/api/login => ${n.status}`),!n.ok)throw new Error("login failed");const s=await n.json();if(s&&s.token)return lt(s.token),s.token;throw new Error("no token in response")}async function At(){J("GET /health");const t=await ae("/health");if(J(`/health => ${t.status}`),!t.ok)throw Le("/health not ok"),new Error("health failed");return t.json()}function We(){try{const t=new URLSearchParams(window.location.search),n=t.get("token");n&&lt(n);const s=t.get("api");return s&&Ft(s),!!n}catch{}return!1}async function Bt(){try{return(await ae("/api/auth/check")).status===200}catch{return!1}}async function ct(t="",n){const s=new URLSearchParams;t&&s.set("path",t),n!=null&&n.showHidden&&s.set("showHidden","1");const r=s.toString()?`?${s.toString()}`:"";J(`GET /api/tree${r}`);const a=await ae(`/api/tree${r}`);if(J(`/api/tree${r} => ${a.status}`),!a.ok)throw Le("/api/tree not ok"),new Error("tree failed");return a.json()}async function Wt(t){J(`GET /api/file?path=${t}`);const n=await ae(`/api/file?path=${encodeURIComponent(t)}`);if(J(`/api/file?path=${t} => ${n.status}`),!n.ok)throw Le("/api/file read failed"),new Error("read failed");return n.text()}async function xe(t){J(`GET /api/stat?path=${t}`);const n=await ae(`/api/stat?path=${encodeURIComponent(t)}`);if(J(`/api/stat?path=${t} => ${n.status}`),!n.ok)throw new Error("stat failed");return n.json()}async function Ht(t,n){J(`POST /api/file path=${t} size=${n.length}`);const s=await ae("/api/file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t,content:n})});if(J(`/api/file POST => ${s.status}`),!s.ok)throw Le("/api/file save failed"),new Error("save failed")}async function Ut(t){J(`DELETE /api/file?path=${t}`);const n=await ae(`/api/file?path=${encodeURIComponent(t)}`,{method:"DELETE"});if(J(`/api/file delete => ${n.status}`),!n.ok)throw Le("/api/file delete failed"),new Error("delete failed")}const dt=K.createContext(null);function Vt({children:t}){const[n,s]=K.useState(null),[r,a]=K.useState(null),[h,l]=K.useState(navigator.onLine),[c,u]=K.useState(!1),[f,v]=K.useState(!1),[k,P]=K.useState(!1);o.useState(()=>{if(typeof window>"u")return;const A=new URLSearchParams(window.location.search).get("token");if(A){console.log("[Auth] Token found in URL (sync init):",A),localStorage.setItem("mlcremote_token",A);const G=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState({path:G},"",G)}});const x=K.useCallback(async()=>{if(navigator.onLine)try{const y=await At();s(y),a(Date.now()),await Bt()||(localStorage.removeItem("mlcremote_token"),y.password_auth?u(!0):y.auth_required&&v(!0))}catch{s(null)}},[]);K.useEffect(()=>{const y=()=>{l(!0),x()},A=()=>{l(!1),s(null)};window.addEventListener("online",y),window.addEventListener("offline",A);const G=setInterval(x,60*1e3);x();const Z=()=>P(!0);return window.addEventListener("mlcremote:auth-failed",Z),()=>{window.removeEventListener("online",y),window.removeEventListener("offline",A),window.removeEventListener("mlcremote:auth-failed",Z),clearInterval(G)}},[x]),K.useEffect(()=>{if(!n){P(!1);return}const y=!!n.password_auth,A=!!n.auth_required&&!n.password_auth,G=localStorage.getItem("mlcremote_token");P(!!((y||A)&&!G))},[n]);const _=async y=>{await Ot(y),await x(),u(!1),P(!1)},j=y=>{localStorage.setItem("mlcremote_token",y),x(),v(!1),P(!1)},L=()=>{localStorage.removeItem("mlcremote_token"),x()};return e.jsx(dt.Provider,{value:{health:n,isOnline:h,lastHealthAt:r,refreshHealth:x,login:_,setToken:j,logout:L,showLogin:c,setShowLogin:u,showTokenInput:f,setShowTokenInput:v,showAuthChooser:k,setShowAuthChooser:P},children:t})}function qt(){const t=K.useContext(dt);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}const z=({name:t,className:n,title:s,size:r=16})=>{if(!t)return null;const a=`#${t}`;return e.jsxs("svg",{className:n,width:r,height:r,"aria-hidden":s?void 0:"true",role:s?"img":void 0,children:[s?e.jsx("title",{children:s}):null,e.jsx("use",{href:a})]})},Kt={gif:"icon-image",txt:"icon-text",tar:"icon-archive",cfg:"icon-settings",x:"icon-close",sh:"icon-terminal",home:"icon-home",jpeg:"icon-image",download:"icon-download",upload:"icon-upload",minus:"icon-minus",up:"icon-up",moon:"icon-moon",sun:"icon-sun",png:"icon-image",js:"icon-js",settings:"icon-settings",run:"icon-play",stop:"icon-stop",md:"icon-markdown",markdown:"icon-markdown",gz:"icon-archive",refresh:"icon-refresh",screenshot:"icon-screenshot",dir:"icon-folder",bz2:"icon-archive",cr:"icon-chevron-right",user:"icon-user",server:"icon-server",log:"icon-log",trash:"icon-trash",json:"icon-json",shell:"icon-terminal",search:"icon-search",mjs:"icon-js",warn:"icon-warning",plus:"icon-plus",view:"icon-view",link:"icon-link",pdf:"icon-pdf",svg:"icon-image",zip:"icon-archive",close:"icon-close",info:"icon-info",cl:"icon-chevron-left",copy:"icon-copy",jpg:"icon-image"};function ye(t){if(t)return Kt[t.toLowerCase()]}function ut(t,n){if(n){const s=n.lastIndexOf(".");if(s>=0&&s<n.length-1){const r=n.slice(s+1).toLowerCase();return ye(r)}}}const O=t=>"icon-"+t;function Gt({x:t,y:n,items:s,onClose:r}){const a=o.useRef(null);o.useEffect(()=>{function c(u){a.current&&!a.current.contains(u.target)&&r()}return window.addEventListener("mousedown",c),window.addEventListener("scroll",r,!0),window.addEventListener("resize",r),()=>{window.removeEventListener("mousedown",c),window.removeEventListener("scroll",r,!0),window.removeEventListener("resize",r)}},[r]);const[h,l]=o.useState({x:t,y:n});return o.useLayoutEffect(()=>{if(a.current){const c=a.current.getBoundingClientRect();let u=t,f=n;u+c.width>window.innerWidth&&(u=window.innerWidth-c.width-8),f+c.height>window.innerHeight&&(f=window.innerHeight-c.height-8),l({x:u,y:f})}},[t,n]),e.jsx("div",{ref:a,style:{position:"fixed",left:h.x,top:h.y,background:"var(--panel)",border:"1px solid var(--border)",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",borderRadius:6,padding:4,zIndex:99999,minWidth:160,display:"flex",flexDirection:"column"},onContextMenu:c=>{c.preventDefault(),r()},children:s.map((c,u)=>c.separator?e.jsx("div",{style:{height:1,background:"var(--border)",margin:"4px 0"}},u):e.jsxs("button",{className:"context-menu-item",onClick:()=>{r(),c.action()},style:{display:"flex",alignItems:"center",gap:8,padding:"6px 10px",border:"none",background:"transparent",color:c.danger?"var(--danger)":"var(--text)",cursor:"pointer",textAlign:"left",borderRadius:4,fontSize:13},onMouseEnter:f=>f.currentTarget.style.background=c.danger?"rgba(239,68,68,0.1)":"var(--bg)",onMouseLeave:f=>f.currentTarget.style.background="transparent",children:[c.icon&&e.jsx("span",{style:{width:16,display:"flex"},children:c.icon}),c.label]},u))})}function Xt({onSelect:t,showHidden:n,onToggleHidden:s,autoOpen:r=!0,onView:a,onBackendActive:h,onChangeRoot:l,canChangeRoot:c,selectedPath:u,activeDir:f,onDirChange:v,focusRequest:k,reloadSignal:P}){const{t:x}=ne(),[_,j]=o.useState(""),[L,y]=o.useState([]),[A,G]=o.useState(!1),[Z,B]=o.useState(""),[pe,se]=o.useState(null),[le,ce]=o.useState(!1),[p,R]=o.useState(null),w=o.useCallback(async d=>{G(!0),B("");try{const C=await ct(d,{showHidden:n});y(C),j(d);try{W.current!==d&&(v==null||v(d),W.current=d)}catch{}h==null||h();try{const U=de.current;U&&requestAnimationFrame(()=>{const H=Q.current;if(H)try{const re=H.querySelector(`[data-path="${CSS.escape(U)}"]`);re&&(re.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"}),re.focus())}catch{}})}catch{}}catch(C){B(C.message||x("status_failed"))}finally{G(!1)}},[n,h,v,x]),W=o.useRef("");o.useEffect(()=>{typeof f>"u"||f!==_&&w(f)},[f,_,w]),o.useEffect(()=>{w("")},[w]),o.useEffect(()=>{w(_||"")},[_,w,P]);const S=()=>{if(!_||_==="/"){w("");return}const d=_.split("/").filter(Boolean);d.pop();const C=`/${d.join("/")}`;w(C||"")},I=async(d,C)=>{if(!(!C||C.length===0)){ce(!0),B("");try{const U=new FormData;for(let Y=0;Y<C.length;Y++)U.append("file",C[Y],C[Y].name);const H=`?path=${encodeURIComponent(d)}`;if(!(await ae(`/api/upload${H}`,{method:"POST",body:U})).ok)throw new Error(x("status_failed"));await w(d)}catch(U){B(U.message||x("status_failed"))}finally{ce(!1)}}},V=(d,C)=>{d.preventDefault(),se(null),I(C,d.dataTransfer.files)},X=(d,C)=>{d.preventDefault(),se(C)},oe=d=>{d.preventDefault(),se(null)},Q=o.useRef(null),de=o.useRef("");o.useEffect(()=>{de.current=u||""},[u]),o.useEffect(()=>{if(u)try{const d=Q.current;if(!d)return;const C=d.querySelector(`li[key="${CSS.escape(u)}"]`),U=d.querySelector(`[data-path="${u}"]`),H=C||U;if(H){H.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"});const re=H.querySelector("button.entry");re&&re.focus()}}catch{}},[u,_]),o.useEffect(()=>{if(k)try{const d=u||"";if(!d)return;const C=Q.current;if(!C)return;const U=CSS.escape(d),H=C.querySelector(`[data-path="${U}"]`);H&&(H.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"}),H.focus())}catch{}},[k,u]);const be=async d=>{if(confirm(x("delete_confirm",{path:d})))try{await Ut(d),w(_)}catch(C){alert(x("status_failed")+": "+C.message)}},_e=(d,C)=>{d.preventDefault(),d.stopPropagation(),R({x:d.clientX,y:d.clientY,item:C})};return e.jsxs("div",{className:"explorer",children:[e.jsxs("div",{className:"explorer-header",children:[e.jsx("strong",{className:"hidden",children:e.jsx(z,{name:O("dir")})}),e.jsxs("div",{className:"explorer-controls",children:[e.jsx("button",{className:"link icon-btn",title:x("refresh"),onClick:()=>w(_||""),children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M23 4v6h-6"}),e.jsx("path",{d:"M1 20v-6h6"}),e.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}),c&&typeof l=="function"&&e.jsx("button",{className:"link icon-btn","aria-label":x("change_root"),title:x("change_root"),onClick:async()=>{try{await Promise.resolve(l(""))}catch{}},children:e.jsx(z,{name:O("dir")})})]}),e.jsxs("div",{className:"breadcrumbs",children:[e.jsx("button",{type:"button",className:"link",onClick:()=>w(""),children:"root"}),_&&_.split("/").filter(Boolean).map((d,C,U)=>{const H=`/${U.slice(0,C+1).join("/")}`;return e.jsxs("span",{children:[" / ",e.jsx("button",{className:"link",onClick:()=>w(H),children:d})]},H)})]})]}),e.jsxs("div",{className:"explorer-body",onDrop:d=>V(d,_||""),onDragOver:d=>X(d,_||""),onDragLeave:oe,children:[A&&e.jsx("div",{className:"muted",children:x("loading")}),Z&&e.jsx("div",{className:"error",children:Z}),le&&e.jsxs("div",{className:"muted",children:[x("upload"),"..."]}),!A&&!Z&&e.jsxs("ul",{className:"entry-list",ref:Q,children:[_&&_!=="/"&&e.jsx("li",{children:e.jsx("button",{type:"button",className:"entry",onClick:S,children:".."})},"up"),L.map(d=>e.jsx("li",{onContextMenu:C=>_e(C,d),children:d.isDir?e.jsxs("button",{"data-path":d.path,type:"button",className:"entry"+(u===d.path?" selected":""),onClick:()=>{w(d.path),t(d.path,!0)},onDrop:C=>V(C,d.path),onDragOver:C=>X(C,d.path),onDragLeave:oe,children:[e.jsx("span",{className:"icon",children:e.jsx(z,{name:ye("dir")||O("dir")})})," ",d.name,d.isSymlink&&e.jsx("span",{title:"Symbolic Link",style:{marginLeft:4,opacity:.5},children:"ðŸ”—"}),d.isBroken&&e.jsx("span",{title:"Broken Link",style:{marginLeft:4},children:"âŒ"}),d.isExternal&&e.jsx("span",{title:"External Link",style:{marginLeft:4},children:"â†—ï¸"}),pe===d.path?e.jsx("span",{style:{marginLeft:8,fontSize:12,color:"#888"},children:x("drop_to_upload")}):null]}):e.jsxs("div",{style:{display:"flex",gap:2,alignItems:"center"},children:[e.jsxs("button",{"data-path":d.path,type:"button",className:"entry",style:{flex:1,textAlign:"left"},onClick:()=>{if(r===!1){t(d.path,!1);return}t(d.path,!1)},children:[e.jsx("span",{className:"icon",children:e.jsx(z,{name:ut(void 0,d.name)||ye(d.name.split(".").pop()||"")||O("view")||"icon-text"})})," ",d.name,d.isSymlink&&e.jsx("span",{title:"Symbolic Link",style:{marginLeft:4,opacity:.5},children:"ðŸ”—"}),d.isBroken&&e.jsx("span",{title:"Broken Link",style:{marginLeft:4},children:"âŒ"}),d.isExternal&&e.jsx("span",{title:"External Link",style:{marginLeft:4},children:"â†—ï¸"})]}),r?null:e.jsx("button",{className:"btn",onClick:()=>a?a(d.path):t(d.path,!1),title:x("view_file"),children:e.jsx(z,{name:O("view")})})]})},d.path))]})]}),p&&e.jsx(Gt,{x:p.x,y:p.y,onClose:()=>R(null),items:[{label:x("open"),icon:e.jsx(z,{name:O("view")}),action:()=>{p.item.isDir?(w(p.item.path),t(p.item.path,!0)):r?t(p.item.path,!1):a?a(p.item.path):t(p.item.path,!1)}},{label:x("download"),icon:e.jsx(z,{name:O("download")}),action:()=>{const d=document.createElement("a");d.href=Ee(`/api/file?path=${encodeURIComponent(p.item.path)}${localStorage.getItem("mlcremote_token")?`&token=${encodeURIComponent(localStorage.getItem("mlcremote_token")||"")}`:""}`),d.download=p.item.name,document.body.appendChild(d),d.click(),document.body.removeChild(d)},separator:!0},{label:x("copy_full_path"),icon:e.jsx(z,{name:O("copy")}),action:async()=>{try{await navigator.clipboard.writeText(p.item.path)}catch(d){console.error("Failed to copy",d)}}},{label:x("copy_relative_path"),icon:e.jsx(z,{name:O("link")}),action:async()=>{try{const d=p.item.path.startsWith("/")?p.item.path.slice(1):p.item.path;await navigator.clipboard.writeText(d)}catch(d){console.error("Failed to copy",d)}}},{label:x("copy_name"),icon:e.jsx(z,{name:O("text")}),action:async()=>{try{await navigator.clipboard.writeText(p.item.name)}catch(d){console.error(d)}},separator:!0},{label:x("delete"),icon:e.jsx(z,{name:O("trash")}),danger:!0,action:()=>be(p.item.path)}].filter(d=>!(d.label===x("download")&&p.item.isDir))})]})}function Yt({autoOpen:t,showHidden:n,onToggleAutoOpen:s,onToggleShowHidden:r,showLogs:a,onToggleLogs:h,hideMemoryUsage:l,onToggleHideMemoryUsage:c,onClose:u}){const{t:f,i18n:v}=ne(),[k,P]=K.useState(l),x=j=>{v.changeLanguage(j)},_=[{code:"en",name:"English"},{code:"de",name:"Deutsch"},{code:"es",name:"EspaÃ±ol"},{code:"fr",name:"FranÃ§ais"}];return e.jsx("div",{style:{position:"absolute",right:12,top:40,zIndex:60},children:e.jsxs("div",{style:{width:320,background:"var(--bg)",border:"1px solid var(--muted)",borderRadius:6,boxShadow:"0 6px 20px rgba(0,0,0,0.12)",padding:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("strong",{children:f("settings")}),e.jsx("button",{"aria-label":f("close"),title:f("close"),onClick:u,style:{background:"transparent",border:"none",cursor:"pointer"},children:e.jsx(z,{name:O("close"),size:16})})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,textTransform:"uppercase",color:"var(--text-muted)",display:"block",marginBottom:8,letterSpacing:"0.05em"},children:f("language")}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:2,background:"var(--bg-panel)",borderRadius:6,border:"1px solid var(--border)",overflow:"hidden"},children:_.map(j=>{const L=v.language===j.code||j.code==="en"&&!v.language;return e.jsxs("button",{onClick:()=>x(j.code),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",background:L?"var(--bg-select)":"transparent",color:L?"var(--accent)":"inherit",border:"none",cursor:"pointer",fontSize:13,textAlign:"left",transition:"background 0.2s"},onMouseOver:y=>{L||(y.currentTarget.style.background="rgba(255,255,255,0.05)")},onMouseOut:y=>{L||(y.currentTarget.style.background="transparent")},children:[e.jsx("span",{style:{fontWeight:L?600:400},children:j.name}),L&&e.jsx(z,{name:O("check"),size:14})]},j.code)})})]}),e.jsx("div",{style:{marginTop:12},children:e.jsxs("label",{style:{fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:t,onChange:j=>s(j.target.checked)})," ",f("auto_open_files","Auto open files")]})}),e.jsx("div",{style:{marginTop:8},children:e.jsxs("label",{style:{fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:n,onChange:j=>r(j.target.checked)})," ",f("show_hidden_files","Show hidden files")]})}),e.jsx("div",{style:{marginTop:8},children:e.jsxs("label",{style:{fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:a,onChange:j=>h(j.target.checked)})," ",f("show_server_logs","Show server logs")]})}),e.jsx("div",{style:{marginTop:8},children:e.jsxs("label",{style:{fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:k,onChange:j=>{P(j.target.checked),c(j.target.checked)}})," ",f("hide_memory_usage","Hide memory usage gauge")]})})]})})}function Jt(){const{t}=ne(),[n,s]=o.useState(null),[r,a]=o.useState(!1),h=o.useCallback(async()=>{a(!0);try{const u=await ae("/api/trash/recent");if(!u.ok)throw new Error("fetch failed");const f=await u.json();Array.isArray(f)&&f.length>0?s(f[0]):s(null)}catch(u){console.warn("Failed to fetch trash",u)}finally{a(!1)}},[]);if(o.useEffect(()=>{h();const u=setInterval(h,1e4);return()=>clearInterval(u)},[h]),r&&!n)return e.jsx("div",{className:"muted",children:t("loading_trash")});if(!n)return e.jsx("div",{className:"muted",children:t("trash_empty")});const l=n.originalPath.split("/").pop()||n.originalPath,c=ut(void 0,l)||ye(l.split(".").pop()||"")||"icon-trash";return e.jsxs("div",{style:{padding:12},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx(z,{name:c,size:20}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{fontWeight:600},children:l}),e.jsx("div",{className:"muted",style:{fontSize:12},children:new Date(n.deletedAt).toLocaleString()})]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsxs("div",{className:"muted",children:[t("original_path"),": ",n.originalPath]}),e.jsxs("div",{className:"muted",children:[t("trash_path"),": ",n.trashPath]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("button",{className:"btn",disabled:!0,children:t("undo_coming")}),(()=>{const u=Ve(),f=`/api/file?path=${encodeURIComponent(n.trashPath)}`+(u?`&token=${encodeURIComponent(u)}`:"");return e.jsx("a",{className:"btn",style:{marginLeft:8},href:f,download:l,children:t("download")})})()]})]})}function me(t){if(!t||t<=0)return"0 B";const n=1024,s=n*1024,r=s*1024;return t>=r?`${(t/r).toFixed(2)} GB`:t>=s?`${(t/s).toFixed(2)} MB`:t>=n?`${(t/n).toFixed(2)} KB`:`${t} B`}const Zt=new Set(["txt","md","markdown","yaml","yml","json","js","ts","jsx","tsx","html","css","env","ini","cfg","conf","csh","gitignore","dockerfile","sql"]),Qt=new Set(["zip","gz","tar","rar","exe","dll","so","bin","jpg","jpeg","png","gif","webp","pdf"]);function qe(t){const n=t.split("/"),s=n[n.length-1]||"",r=s.lastIndexOf(".");return r===-1?"":s.slice(r+1).toLowerCase()}function en(t){const n=qe(t);return!n||Zt.has(n)?!0:!Qt.has(n)}async function tn(t){if(!t)return{mime:"application/octet-stream",isText:!1,ext:""};try{const n=`?path=${encodeURIComponent(t)}`,s=await ae(`/api/filetype${n}`);if(!s.ok)throw new Error("probe failed");return await s.json()}catch{const s=qe(t);return{mime:"application/octet-stream",isText:en(t),ext:s}}}function nn(t){if(!t)return null;const n=t.split("/"),r=(n[n.length-1]||"").toLowerCase();return r===".bashrc"||r==="bashrc"||r===".bash_profile"||r===".profile"?"bashrc":r===".zshrc"||r==="zshrc"?"zshrc":r===".bash_history"||r==="bash_history"?"bash_history":r==="makefile"?"makefile":r==="dockerfile"?"dockerfile":r==="nginx.conf"||r==="nginx.conf.default"?"conf":null}function sn(t){const n=Ue.languages;switch(t){case"jsx":return n.jsx;case"tsx":return n.tsx;case"java":return n.java;case"ini":return n.ini;case"js":return n.javascript;case"ts":return n.typescript;case"go":return n.go;case"php":return n.php;case"json":return n.json;case"yaml":case"yml":return n.yaml;case"toml":return n.toml||n.markup;case"md":case"markdown":return n.markdown;case"c":case"h":return n.c;case"cpp":case"hpp":return n.cpp;case"py":return n.python;case"makefile":return n.makefile;case"bashrc":case"zshrc":case"bash_history":case"profile":return n.bash;case"sh":case"bash":return n.bash;case"xml":case"xml-doc":return n["xml-doc"];case"html":case"htm":return n.markup;case"css":case"sass":case"scss":return n.sass;case"sql":return n.sql;default:return n.javascript}}function ke(t){switch(t){case"js":case"jsx":return"javascript";case"ts":case"tsx":return"typescript";case"go":return"go";case"php":return"php";case"json":return"json";case"yaml":case"yml":return"yaml";case"toml":return"toml";case"ini":return"ini";case"md":case"markdown":return"markdown";case"c":case"h":return"c";case"cpp":case"cxx":case"c++":case"hpp":return"cpp";case"py":return"python";case"makefile":return"makefile";case"dockerfile":return"dockerfile";case"sh":case"bash":case"csh":return"bash";case"bashrc":case"zshrc":case"bash_history":case"profile":return"bash";case"xml":case"xml-doc":return"xml-doc";case"html":case"htm":return"markup";case"sass":case"scss":return"sass";case"sql":return"sql";case"less":case"css":return"css";default:return"text"}}function it(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function on(t,n){try{const s=sn(n),r=ke(n);return s?Ue.highlight(t,s,r):it(t)}catch(s){return console.warn("Prism highlight failed",s),it(t)}}function rn({content:t,setContent:n,origContent:s,ext:r,alias:a,textareaId:h}){const{t:l}=ne(),c=o.useRef(null),u=o.useRef(null);return o.useEffect(()=>{var v;const f=a||ke(r);u.current&&u.current.setAttribute("data-grammar",f),c.current&&c.current.setAttribute("data-grammar",f);try{const k=(v=u.current)==null?void 0:v.querySelector("code");k&&Ue.highlightElement(k)}catch{}},[a,t,r]),o.useEffect(()=>{c.current&&u.current&&(u.current.scrollTop=c.current.scrollTop,u.current.scrollLeft=c.current.scrollLeft)},[t]),e.jsxs("div",{className:"editor-edit-area",children:[e.jsx("pre",{"aria-hidden":!0,className:`highlight-wrap language-${a||ke(r)}`,"data-grammar":a||ke(r),ref:f=>{u.current=f},children:e.jsx("code",{className:`language-${a||ke(r)}`,dangerouslySetInnerHTML:{__html:on(t||"",r)}})}),e.jsx("textarea",{ref:c,className:"textarea",wrap:"off",value:t,name:h||"editor",id:h,"data-grammar":a,onChange:f=>n(f.target.value),onScroll:()=>{c.current&&u.current&&(u.current.scrollTop=c.current.scrollTop,u.current.scrollLeft=c.current.scrollLeft)},placeholder:l("open_or_create_file"),spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",autoComplete:"off"})]})}function an({path:t,onDimensions:n}){const{t:s}=ne(),r=Ve(),a=Ee(`/api/file?path=${encodeURIComponent(t)}${r?`&token=${encodeURIComponent(r)}`:""}`),[h,l]=o.useState(null),c=o.useRef(null);return e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",overflow:"hidden"},children:e.jsx("img",{ref:c,src:a,alt:t.split("/").pop(),style:{maxWidth:"100%",maxHeight:"80vh",objectFit:"contain",borderRadius:6,boxShadow:"0 2px 8px rgba(0,0,0,0.4)"},onLoad:()=>{try{const u=c.current;if(u&&u.naturalWidth&&u.naturalHeight){l({w:u.naturalWidth,h:u.naturalHeight});try{n&&n(u.naturalWidth,u.naturalHeight)}catch{}}}catch{}}})}),e.jsxs("div",{style:{marginTop:8,display:"flex",gap:8,alignItems:"center"},children:[e.jsx("a",{className:"link",href:a,download:t.split("/").pop(),children:s("download")}),h?e.jsxs("span",{className:"muted",style:{marginLeft:8},children:[h.w," Ã— ",h.h]}):null]})]})}const ln=o.lazy(()=>Re(()=>import("./PdfPreview-Dz2bbC-Y.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url));function cn({path:t}){const{t:n}=ne();return e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"muted",children:n("loading_pdf")}),children:e.jsx(ln,{path:t})})}const dn=o.lazy(()=>Re(()=>import("./ShellView-CLbCGdhl.js"),__vite__mapDeps([10,1,2,3,4,11,6,7,5,8,9]),import.meta.url)),un={name:"Shell",priority:100,matches:t=>!!(t.path&&t.path.startsWith("shell-")),view:({path:t})=>e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"muted",children:"Loading shellâ€¦"}),children:e.jsx(dn,{path:t})}),isEditable:!1},hn={name:"Directory",priority:90,matches:t=>!!(t.meta&&t.meta.isDir),view:({path:t,origContent:n})=>e.jsxs("div",{style:{padding:12},children:[e.jsxs("div",{style:{fontWeight:600},children:["Directory: ",t]}),e.jsxs("div",{className:"muted",style:{marginTop:6},children:[n?n.split(`
`).length:"0"," entries"]}),e.jsx("pre",{style:{marginTop:8,maxHeight:240,overflow:"auto",padding:8,background:"var(--panel)"},children:n})]}),isEditable:!1},fn={name:"PDF",priority:80,matches:t=>t.probe&&t.probe.mime==="application/pdf"||!!t.path&&t.path.toLowerCase().endsWith(".pdf"),view:({path:t})=>e.jsx(cn,{path:t}),isEditable:!1},mn={name:"Image",priority:70,matches:t=>{if(t.probe&&t.probe.mime&&t.probe.mime.startsWith("image/"))return!0;if(t.path){const n=t.path.toLowerCase();return n.endsWith(".png")||n.endsWith(".jpg")||n.endsWith(".jpeg")||n.endsWith(".gif")||n.endsWith(".svg")||n.endsWith(".webp")}return!1},view:({path:t,onDimensions:n})=>e.jsx(an,{path:t,onDimensions:n}),isEditable:!1},pn={name:"Text",priority:50,matches:t=>{if(t.probe&&t.probe.isText)return!0;if(t.path){const n=t.path.toLowerCase();return n.endsWith(".md")||n.endsWith(".txt")||n.endsWith(".json")||n.endsWith(".js")||n.endsWith(".ts")||n.endsWith(".tsx")||n.endsWith(".css")||n.endsWith(".html")||n.endsWith(".go")||n.endsWith(".py")||n.endsWith(".java")||n.endsWith(".c")||n.endsWith(".cpp")||n.endsWith(".h")||n.endsWith(".sh")||n.endsWith(".bat")||n.endsWith(".ps1")||n.endsWith(".yaml")||n.endsWith(".yml")||n.endsWith(".toml")||n.endsWith(".ini")}return!1},view:({content:t,setContent:n,origContent:s,ext:r,alias:a,textareaId:h})=>e.jsx(rn,{content:t||"",setContent:n||(()=>{}),origContent:s||"",ext:r||"",alias:a,textareaId:h||"editor"}),isEditable:!0},gn={name:"Binary",priority:10,matches:t=>!!(t.probe&&!t.probe.isText),view:({path:t})=>e.jsxs("div",{style:{marginTop:8,display:"flex",gap:8},children:[e.jsx("a",{className:"link",href:Ee(`/api/file?path=${encodeURIComponent(t)}`),download:t.split("/").pop(),children:"Download"}),e.jsx("span",{className:"muted",children:"(Binary or unsupported file type)"})]}),isEditable:!1},ht={name:"Unsupported",priority:0,matches:()=>!0,view:({path:t})=>e.jsxs("div",{style:{padding:12},className:"muted",children:["Unsupported file type: ",t]}),isEditable:!1},xn=[un,hn,fn,mn,pn,gn,ht].sort((t,n)=>n.priority-t.priority);function He(t){for(const n of xn)if(n.matches(t))return n;return ht}function yn(t){return t.charCodeAt(0)===65279?{text:t.slice(1),hasBOM:!0}:{text:t,hasBOM:!1}}function _n(t){return"\uFEFF"+t}function vn({path:t,onSaved:n,settings:s,reloadTrigger:r,onUnsavedChange:a,onMeta:h}){const{t:l}=ne(),[c,u]=o.useState(""),[f,v]=o.useState(""),[k,P]=o.useState(!1),[x,_]=o.useState(""),[j,L]=o.useState(!1),[y,A]=o.useState(null),[G,Z]=o.useState(!1),[B,pe]=o.useState(null),[se,le]=o.useState(null),[ce,p]=o.useState(null),[R,w]=o.useState(null),[W,S]=o.useState(!1),I=o.useRef(null),V=o.useRef(null),X=o.useRef(null),oe=He({path:t,meta:y,probe:B}),Q=oe.view,de=o.useCallback(async(E=!1)=>{if(t){L(!0),_("");try{const T=await xe(t);if(A(T),typeof h=="function"&&h(T),!E&&ce&&R&&T.modTime!==R&&!confirm(l("confirm_reload_external","File has been modified externally. Reload?"))){L(!1);return}w(T.modTime);const ee=await tn(t);pe(ee);const fe=He({path:t,meta:T,probe:ee});if(T.isDir){u(""),L(!1);return}if(fe.name==="Text"){const ve=await Wt(t),{text:je,hasBOM:Ne}=yn(ve);u(je),v(je),P(Ne),p(Date.now()),S(!1)}else u(""),L(!1)}catch{B&&B.isText&&(_(l("failed_to_load","Failed to load")),S(!0)),p(null)}finally{L(!1)}}},[t,l]),be=10*1024*1024,_e=async(E,T=64*1024)=>{if(t){Z(!0);try{const ee=`?path=${encodeURIComponent(t)}&offset=${E}&length=${T}`,fe=await ae(`/api/file/section${ee}`);if(!fe.ok)throw new Error("section fetch failed");const ve=await fe.text();u(ve),v(ve)}catch{_(l("failed_to_load_section","Failed to load section"))}finally{Z(!1)}}},C=nn(t)||B&&B.ext||qe(t),U=void 0,H=B&&B.ext?B.ext:"text",Y=(E=>E?"editor-"+E.replace(/[^a-z0-9_-]/gi,"-").replace(/-+/g,"-"):"editor")(t||"");o.useEffect(()=>{de()},[de]),o.useEffect(()=>{let E=!0;return(async()=>{if(!(!y||!y.isDir||!t))try{const T=await ct(t);if(!E)return;u(""),v(T.map(ee=>ee.name).join(`
`))}catch{}})(),()=>{E=!1}},[y,t]),o.useEffect(()=>{r&&r>0&&de(!0)},[r,de]),o.useEffect(()=>{I.current&&V.current&&(V.current.scrollTop=I.current.scrollTop,V.current.scrollLeft=I.current.scrollLeft)},[c]),o.useEffect(()=>{if(I.current&&V.current){const E=window.getComputedStyle(V.current),T=E.lineHeight,ee=E.paddingTop,fe=E.paddingBottom;T&&(I.current.style.lineHeight=T),ee&&(I.current.style.paddingTop=ee),fe&&(I.current.style.paddingBottom=fe)}},[c,t]),o.useEffect(()=>{var E;V.current&&V.current.setAttribute("data-grammar",H),I.current&&(I.current.setAttribute("data-grammar",H),Y&&(I.current.id=Y));try{const T=(E=V.current)==null?void 0:E.querySelector("code");T&&Prism.highlightElement(T)}catch{}},[H,c,Y]),o.useEffect(()=>{if(!a||!oe.isEditable)return;const E=c!==f;if(X.current===null||X.current!==E){try{a(t,E)}catch(T){console.warn("onUnsavedChange threw",T)}X.current=E}},[c,f,a,t,oe.isEditable]);const ge=async()=>{if(t){_(l("saving","Saving..."));try{const E=k?_n(c):c;await Ht(t,E),_(l("saved","Saved")),setTimeout(()=>_(T=>T===l("saved","Saved")?"":T),1500),await de(!0),n&&n()}catch{_(l("save_failed","Save failed"))}}},ze=async()=>{if(t&&!(c!==f&&!confirm(l("confirm_reload_unsaved","You have unsaved changes. Reloading will discard them. Continue?")))){_(l("reloading","Reloading..."));try{await de(!0),_(l("reloaded","Reloaded")),setTimeout(()=>_(E=>E===l("reloaded","Reloaded")?"":E),1500)}catch{_(l("reload_failed","Reload failed"))}}};return o.useEffect(()=>{const E=T=>{(T.ctrlKey||T.metaKey)&&T.key==="s"&&(T.preventDefault(),ge())};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[ge]),e.jsxs("div",{className:"editor",children:[e.jsxs("div",{className:"editor-header",children:[e.jsx("strong",{children:l("editor")}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{className:"muted",children:y&&y.absPath?y.absPath:t||l("select_or_create")}),y&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"muted",style:{fontSize:11},children:[y.isDir?"directory":oe.name,"Â· ",y.mode," Â· ",new Date(y.modTime).toLocaleString()," ",y.size?`Â· ${me(y.size)}`:""]}),se&&oe.name==="Image"?e.jsxs("span",{style:{fontSize:11,marginLeft:8},className:"muted",children:[se.w," Ã— ",se.h]}):null]})]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"link icon-btn",title:l("refresh"),"aria-label":l("refresh"),onClick:ze,disabled:!t,children:e.jsx(z,{name:ye("refresh")||"icon-refresh",title:l("refresh"),size:16})}),oe.isEditable&&c!==f&&e.jsx("button",{className:"link icon-btn",title:l("save"),"aria-label":l("save"),onClick:ge,disabled:!t,children:e.jsx(z,{name:ye("upload")||"icon-upload",title:l("save"),size:16})})]}),y&&y.size&&y.size>be&&oe.isEditable?e.jsxs("div",{style:{marginLeft:12},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:l("file_too_large","File is large ({{size}}). Full edit disabled.",{size:me(y.size)})}),e.jsxs("div",{style:{marginTop:6,display:"flex",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>_e(0,64*1024),children:l("view_head","View head")}),e.jsx("button",{className:"btn",onClick:()=>_e(Math.max(0,(y.size||0)-64*1024),64*1024),children:l("view_tail","View tail")})]}),G&&e.jsx("div",{className:"muted",children:l("loading_section","Loading section...")})]}):null,x&&e.jsx("div",{className:"muted",children:x})]}),e.jsx("div",{className:"editor-body",children:j?e.jsx("div",{className:"muted",children:l("loading")}):e.jsx(Q,{path:t,content:c,setContent:u,origContent:f,ext:C,alias:U,textareaId:Y,onDimensions:(E,T)=>le({w:E,h:T})})})]})}function wn({path:t}){const{t:n}=ne(),[s,r]=o.useState(null),[a,h]=o.useState(null);return o.useEffect(()=>{let l=!0;return(async()=>{if(!t){r(null);return}try{const c=await xe(t);if(!l)return;r(c),h(null)}catch(c){if(!l)return;h((c==null?void 0:c.message)||n("failed_fetch_metadata")),r(null)}})(),()=>{l=!1}},[t,n]),t?e.jsxs("div",{style:{padding:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:t.split("/").pop()}),e.jsx("div",{className:"muted",style:{fontSize:12},children:t})]}),e.jsx("div",{children:e.jsx("a",{className:"link",href:`/api/file?path=${encodeURIComponent(t)}`,download:t.split("/").pop(),children:n("download")})})]}),e.jsxs("div",{style:{marginTop:12},children:[a?e.jsx("div",{className:"error",children:a}):null,s?e.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{width:160,padding:6},className:"muted",children:n("full_path")}),e.jsx("td",{style:{padding:6},children:s.path||t})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"muted",style:{padding:6},children:n("mime")}),e.jsx("td",{style:{padding:6},children:s.mime||"unknown"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"muted",style:{padding:6},children:n("size")}),e.jsx("td",{style:{padding:6},children:s.size?me(s.size):"n/a"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"muted",style:{padding:6},children:n("mode")}),e.jsx("td",{style:{padding:6},children:s.mode||"n/a"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"muted",style:{padding:6},children:n("last_modified")}),e.jsx("td",{style:{padding:6},children:s.modTime?new Date(s.modTime).toLocaleString():"n/a"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"muted",style:{padding:6},children:n("is_dir")}),e.jsx("td",{style:{padding:6},children:s.isDir?n("yes"):n("no")})]})]})}):e.jsx("div",{className:"muted",children:n("loading_metadata")})]})]}):e.jsx("div",{style:{padding:12},className:"muted",children:n("no_file_selected")})}function bn({openFiles:t,active:n,onActivate:s,onClose:r,onCloseOthers:a,onCloseLeft:h,titles:l,fullPaths:c,types:u,evictedTabs:f=[],onRestoreEvicted:v}){const{t:k}=ne(),[P,x]=o.useState(null),_=o.useRef(null),j=o.useRef(null),[L,y]=o.useState(!1),[A,G]=o.useState(!1),[Z,B]=o.useState(!1),[pe,se]=o.useState(null),le=()=>{const p=j.current;if(!p){y(!1),G(!1);return}y(p.scrollLeft>0),G(p.scrollWidth>p.clientWidth+p.scrollLeft+1)},ce=p=>{const R=j.current;R&&(R.scrollBy({left:p,behavior:"smooth"}),setTimeout(le,220))};return o.useEffect(()=>{function p(w){_.current&&(w.target instanceof Node&&_.current.contains(w.target)||x(null))}function R(w){w.key==="Escape"&&x(null)}return document.addEventListener("click",p),document.addEventListener("keydown",R),()=>{document.removeEventListener("click",p),document.removeEventListener("keydown",R)}},[]),o.useEffect(()=>{le();function p(){le()}window.addEventListener("resize",p);function R(){const w=j.current,W=140;if(!w){se(null);return}const S=w.clientWidth,I=Math.max(1,Math.floor(S/W));se(I)}return window.addEventListener("resize",R),R(),()=>{window.removeEventListener("resize",p),window.removeEventListener("resize",R)}},[t]),e.jsxs("div",{className:"tabbar",ref:_,children:[(()=>{const R=j.current?j.current.clientWidth:600,w=pe??Math.max(1,Math.floor(R/140)),W=t.length>w?t.slice(0,t.length-w):[];return W.length===0?null:e.jsxs("div",{className:"tab-evicted-dropdown",style:{display:"flex",alignItems:"center",marginRight:8,position:"relative"},children:[e.jsx("button",{className:"btn",onClick:()=>B(S=>!S),children:"â‹¯"}),Z&&e.jsx("div",{style:{position:"absolute",left:0,top:"100%",background:"var(--bg)",boxShadow:"0 4px 12px rgba(0,0,0,0.2)",padding:8,zIndex:50},children:W.map(S=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 8px"},children:[e.jsx("button",{className:"link",onClick:()=>{v&&v(S),B(!1)},style:{flex:1,textAlign:"left"},children:l&&l[S]||S.split("/").pop()}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-small",title:k("restore"),onClick:()=>{v&&v(S),B(!1)},children:"â†º"}),e.jsx("button",{className:"btn btn-small",title:k("close"),onClick:()=>{r&&r(S),B(!1)},children:"âœ•"}),e.jsx("button",{className:"btn btn-small",title:k("close_others"),onClick:()=>{W.filter(I=>I!==S).forEach(I=>r&&r(I)),B(!1)},children:"â‹¯"})]})]},S))})]})})(),L&&e.jsx("button",{className:"tab-scroll tab-scroll-left","aria-label":k("scroll_left"),onClick:()=>ce(-200),children:"â—€"}),e.jsx("div",{className:"tab-scroll-area",ref:j,onScroll:le,children:t.map((p,R)=>e.jsx("div",{className:"tab-item",style:{display:"flex",alignItems:"center",gap:8,padding:"4px 8px"},children:e.jsxs("button",{className:p===n?"btn":"link",onClick:()=>s(p),onContextMenu:w=>{w.preventDefault(),x(R)},style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"tab-icon",children:(()=>{if((u&&u[p])==="shell")return e.jsx(z,{name:O("terminal")});if((u&&u[p])==="dir")return e.jsx(z,{name:O("folder")});const w=(p.split(".").pop()||"").toLowerCase(),W=ye(w);return e.jsx(z,{name:W})})()},`${(u==null?void 0:u[p])||"file"}-${p}`),(()=>{const w=l&&l[p]||p.split("/").pop()||p,W=w.length>10?w.slice(0,10)+"â€¦":w,S=l&&l[p]&&l[p].startsWith("*")?"tab-title tab-unsaved":"tab-title";return e.jsx("span",{title:(c==null?void 0:c[p])||w,className:S,style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:120},children:W})})()]})},p))}),P!==null&&(()=>{const p=t[P];if(!p)return null;const R=_.current,w=j.current;let W={position:"absolute",right:8,top:40,padding:8,display:"flex",flexDirection:"column",gap:6};try{const S=w==null?void 0:w.querySelectorAll(".tab-item"),I=S?S[P]:null;if(I&&R){const V=R.getBoundingClientRect(),X=I.getBoundingClientRect();W={position:"absolute",left:X.left-V.left,top:X.bottom-V.top+6,padding:8,display:"flex",flexDirection:"column",gap:6}}}catch{}return e.jsxs("div",{className:"dropdown",style:W,children:[e.jsx("button",{ref:S=>{S&&S.focus()},className:"link",onClick:()=>{r==null||r(p),x(null)},children:k("close")}),e.jsx("button",{className:"link",onClick:()=>{a==null||a(p),x(null)},children:k("close_others")}),e.jsx("button",{className:"link",onClick:()=>{h==null||h(p),x(null)},children:k("close_left")})]})})(),A&&e.jsx("button",{className:"tab-scroll tab-scroll-right","aria-label":k("scroll_right"),onClick:()=>ce(200),children:"â–¶"})]})}function jn({visible:t=!0,onClose:n}){const{t:s}=ne(),[,r]=o.useState(0);if(o.useEffect(()=>Mt(()=>r(c=>c+1)),[]),!t)return null;const a=It().slice(0,100);function h(l){const c=[],u=/([\w\/\.\-]+:\d+)/g;let f=0,v;for(;(v=u.exec(l))!==null;)v.index>f&&c.push({text:l.slice(f,v.index)}),c.push({text:v[0],cls:"log-path"}),f=v.index+v[0].length;return f<l.length&&c.push({text:l.slice(f)}),c.map((k,P)=>k.cls?e.jsx("span",{className:k.cls,children:k.text},P):e.jsx("span",{children:k.text},P))}return e.jsxs("div",{className:"log-overlay",children:[e.jsxs("div",{className:"log-header",children:[e.jsx("strong",{children:s("logs")}),e.jsxs("div",{children:[e.jsx("button",{className:"btn",onClick:()=>Pt(),children:s("clear")}),e.jsx("button",{className:"btn",onClick:()=>n&&n(),style:{marginLeft:8},children:s("close")})]})]}),e.jsx("div",{children:a.map((l,c)=>e.jsxs("div",{className:`log-entry log-level-${(l.level||"").toLowerCase()}`,children:[e.jsxs("div",{className:"log-meta",children:[l.ts," ",e.jsx("span",{className:"log-level",children:l.level})]}),e.jsx("div",{className:"log-message",children:h(l.msg)})]},c))})]})}async function $n(t,n="mlcremote-screenshot.png"){const s=await Et(t,{backgroundColor:null,scale:2});return new Promise(r=>{s.toBlob(a=>{if(!a){r();return}const h=URL.createObjectURL(a),l=document.createElement("a");l.href=h,l.download=n,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(h),r()},"image/png")})}class kn{constructor(n=""){ot(this,"prefix");this.prefix=n}key(n){return`${this.prefix}${n}`}get(n,s,r=null){try{const a=localStorage.getItem(this.key(n)),h=s.read(a);return h===null?r:h}catch{return r}}getOrDefault(n,s,r){const a=this.get(n,s,null);return a===null?r:a}set(n,s,r){try{localStorage.setItem(this.key(n),r.write(s))}catch{}}remove(n){try{localStorage.removeItem(this.key(n))}catch{}}}const Be={read:t=>t===null?null:t,write:t=>String(t)},he={read:t=>t===null?null:t==="1"||t==="true",write:t=>t?"1":"0"},te=new kn("mlc:");function Sn({title:t,message:n,onClose:s}){const{t:r}=ne();return o.useEffect(()=>{const a=h=>{h.key==="Escape"&&s()};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[s]),e.jsx("div",{className:"login-overlay",onClick:s,children:e.jsxs("div",{className:"login-box",onClick:a=>a.stopPropagation(),style:{minWidth:350,maxWidth:500},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h3",{style:{margin:0,fontSize:18},children:t}),e.jsx("button",{className:"link icon-btn",onClick:s,"aria-label":r("close"),children:e.jsx(z,{name:O("close"),size:16})})]}),e.jsx("div",{style:{marginBottom:24,fontSize:14,lineHeight:"1.5",color:"var(--text-muted)"},children:n}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{className:"btn",onClick:s,children:r("close")})})]})})}function Cn({health:t,isOnline:n,hideMemoryUsage:s,lastHealthAt:r}){const{t:a}=ne(),[h,l]=o.useState(new Date);return o.useEffect(()=>{const c=window.setInterval(()=>l(new Date),1e3);return()=>window.clearInterval(c)},[]),e.jsxs("div",{className:"status-bar",style:{height:24,background:"var(--bg-alt)",borderTop:"1px solid var(--border)",display:"flex",alignItems:"center",padding:"0 8px",fontSize:12,color:"var(--text-muted)",justifyContent:"space-between",userSelect:"none"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},title:r?`${a("last_checked","Last checked")}: ${new Date(r).toLocaleTimeString()}`:"",children:[e.jsx("span",{style:{width:8,height:8,borderRadius:4,background:t&&t.host?"#10b981":n?"#f59e0b":"#ef4444"}}),e.jsx("span",{children:t&&t.host?t.host:n?a("connecting"):a("offline","Offline")})]}),e.jsxs("span",{className:n?"ok":"err",title:a(n?"status_connected":"disconnected"),children:[e.jsx(z,{name:"icon-circle-filled",size:10})," ",n?a("online","Online"):a("offline","Offline")]}),t&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sep"}),e.jsxs("span",{title:`PID: ${t.pid}`,children:["Host: ",t.host||"localhost"]}),t.os&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sep"}),e.jsx("span",{title:`OS: ${t.os} ${t.distro||""}`,children:t.distro||t.os})]}),e.jsx("span",{className:"sep"}),e.jsx("span",{title:a("server_time","Server Time"),children:t.server_time?new Date(t.server_time).toLocaleTimeString():""})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[!s&&t&&t.sys_mem_total_bytes?(()=>{const c=t.sys_mem_total_bytes||1,u=t.sys_mem_free_bytes||0,f=c-u,v=Math.round(f/c*100);return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},title:`System Memory: ${me(f)} / ${me(c)}`,children:[e.jsx("span",{children:"Mem:"}),e.jsx("div",{style:{width:50,height:8,background:"rgba(255,255,255,0.1)",borderRadius:2,overflow:"hidden"},children:e.jsx("div",{style:{width:`${v}%`,height:"100%",background:v>80?"#ef4444":"#10b981"}})}),e.jsxs("span",{children:[v,"%"]})]})})():null,e.jsx("div",{title:h.toLocaleDateString(),children:new Intl.DateTimeFormat(void 0,{hour:"numeric",minute:"numeric",second:"numeric"}).format(h)})]})]})}function Ln({direction:t="vertical",initialSize:n=50,minSize:s=10,onResize:r,children:a,className:h}){const[l,c]=K.useState(n);K.useEffect(()=>{c(n)},[n]);const u=K.useRef(null),f=K.useRef(!1),v=K.useRef(n),k=t==="vertical",P=j=>{j.preventDefault(),f.current=!0,v.current=l,document.addEventListener("mousemove",x),document.addEventListener("mouseup",_),document.body.style.cursor=k?"col-resize":"row-resize",document.body.style.userSelect="none";const L=document.createElement("div");L.id="split-drag-overlay",L.style.position="fixed",L.style.top="0",L.style.left="0",L.style.width="100%",L.style.height="100%",L.style.zIndex="9999",L.style.cursor=k?"col-resize":"row-resize",document.body.appendChild(L)},x=j=>{if(!f.current||!u.current)return;const L=u.current.getBoundingClientRect();let y=0;k?y=(j.clientX-L.left)/L.width*100:y=(j.clientY-L.top)/L.height*100,y=Math.max(s,Math.min(100-s,y)),c(y),v.current=y},_=()=>{f.current=!1,document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",_),document.body.style.cursor="",document.body.style.userSelect="";const j=document.getElementById("split-drag-overlay");j&&j.remove(),r&&r(v.current)};return e.jsxs("div",{ref:u,className:`split-pane-container ${t} ${h||""}`,style:{display:"flex",flexDirection:k?"row":"column",width:"100%",height:"100%",overflow:"hidden"},children:[e.jsx("div",{style:{flexBasis:`${l}%`,flexGrow:0,flexShrink:0,overflow:"hidden",position:"relative"},children:a[0]}),e.jsx("div",{className:"split-resizer",style:{flexBasis:"4px",cursor:k?"col-resize":"row-resize",background:"var(--border-color, #444)",zIndex:100,transition:"background 0.2s",position:"relative",alignSelf:"stretch"},onMouseDown:P,children:e.jsx("div",{style:{position:"absolute",top:k?0:-4,bottom:k?0:-4,left:k?-4:0,right:k?-4:0,zIndex:10}})}),e.jsx("div",{style:{flex:1,overflow:"hidden",position:"relative"},children:a[1]})]})}const En=o.lazy(()=>Re(()=>import("./TerminalTab-2J0oe7jc.js"),__vite__mapDeps([11,1,2,3,4,6,7,5,8,9]),import.meta.url));function Nn(){var tt,nt;const{t}=ne(),{health:n,isOnline:s,lastHealthAt:r,refreshHealth:a,login:h,setToken:l,logout:c,showLogin:u,setShowLogin:f,showTokenInput:v,setShowTokenInput:k,showAuthChooser:P,setShowAuthChooser:x}=qt(),[_,j]=o.useState(0),L=o.useRef(null);o.useEffect(()=>{!L.current&&n&&j(Date.now()),L.current=n},[n]);const[y,A]=o.useState(""),[G,Z]=o.useState(""),B=o.useCallback(i=>Z(i),[]),[pe,se]=o.useState(0),[le,ce]=o.useState(!0),[p,R]=o.useState({root:{id:"root",files:[],activeFile:null}}),[w,W]=o.useState({type:"leaf",paneId:"root"}),[S,I]=o.useState("root"),V=((tt=p[S])==null?void 0:tt.files)||[],X=((nt=p[S])==null?void 0:nt.activeFile)||"",oe=i=>{R(g=>{const m=g[S];if(!m)return g;const N=i(m.files);return{...g,[S]:{...m,files:N}}})},Q=i=>{R(g=>{const m=g[S];return m?{...g,[S]:{...m,activeFile:i}}:g})},[de,be]=o.useState([]),[_e,d]=o.useState(null),[C,U]=o.useState(()=>te.getOrDefault("autoOpen",he,!0)),H=i=>{U(i),te.set("autoOpen",i,he)},re=8;function Y(i){oe(g=>{if(g.includes(i))return g;const m=[...g,i];if(m.length<=re)return m;const N=m[0];try{be($=>$.includes(N)?$:[...$,N])}catch{}return m.slice(1)}),Q(i),xe(i).then(g=>{Ze(m=>({...m,[i]:g}))}).catch(()=>{})}const[ge,ze]=o.useState({}),[E,T]=o.useState(()=>te.getOrDefault("showHidden",he,!1)),ee=i=>{T(i),te.set("showHidden",i,he)},[fe,ve]=o.useState(!1),[je,Ne]=o.useState(()=>te.getOrDefault("showLogs",he,!1)),[ft,De]=o.useState(!1),[mt,Ke]=o.useState(!1),[Ge,pt]=o.useState(()=>te.getOrDefault("hideMemoryUsage",he,!1)),[Ya,Ja]=o.useState(!1),[Ie,Xe]=o.useState(null),[Ye,gt]=o.useState(300),[Te,xt]=o.useState(()=>te.getOrDefault("theme",Be,"dark")),[Za,yt]=o.useState(new Date),[Me,Je]=o.useState(null),[_t,Qa]=o.useState({}),[vt,wt]=o.useState({}),[el,Ze]=o.useState({}),bt=o.useCallback((i,g)=>{wt(m=>({...m,[i]:g}))},[]),Pe=o.useCallback(async()=>{await a()},[a]);o.useEffect(()=>{const i=window.setInterval(()=>yt(new Date),1e3);return()=>window.clearInterval(i)},[]),o.useEffect(()=>{fetch("/api/settings").then(m=>m.json()).then(m=>{Xe(m),m&&typeof m.allowChangeRoot<"u"&&ve(!!m.allowChangeRoot)}).catch(()=>Xe({allowDelete:!1,defaultShell:"bash"}));const g=new URLSearchParams(window.location.search).get("profileId");if(g){console.log("Restoring state for profile:",g);try{const m=localStorage.getItem(`workspace_state_${g}`);if(m){const N=JSON.parse(m);N.panes&&R(N.panes),N.layout&&W(N.layout),N.activePaneId&&I(N.activePaneId)}}catch(m){console.error("Failed to restore workspace state",m)}}},[]),o.useEffect(()=>{const g=new URLSearchParams(window.location.search).get("profileId");if(g){const m={panes:p,layout:w,activePaneId:S};localStorage.setItem(`workspace_state_${g}`,JSON.stringify(m))}},[p,w,S]),o.useEffect(()=>{Te==="light"?document.documentElement.classList.add("theme-light"):document.documentElement.classList.remove("theme-light")},[Te]);const Qe=i=>{const g=`pane-${Date.now()}`,m=p[S],N=m==null?void 0:m.activeFile;R($=>({...$,[g]:{id:g,files:N?[N]:[],activeFile:N||null}})),W($=>{const F=q=>q.type==="leaf"?q.paneId===S?{type:"branch",direction:i,size:50,children:[q,{type:"leaf",paneId:g}]}:q:{...q,children:[F(q.children[0]),F(q.children[1])]};return F($)}),I(g)},et=i=>{i==="root"&&w.type==="leaf"||(W(g=>{const m=$=>{if($.type==="leaf")return $.paneId===i?null:$;const F=m($.children[0]),q=m($.children[1]);return!F&&!q?null:F?q?{...$,children:[F,q]}:F:q};return m(g)||{type:"leaf",paneId:"root"}}),R(g=>{const m={...g};return delete m[i],m}),S===i&&I("root"))},jt=(i,g)=>{W(m=>{const N=$=>$===i?{...$,size:g}:$.type==="branch"?{...$,children:[N($.children[0]),N($.children[1])]}:$;return N(m)})},Fe=i=>i.type==="leaf"?$t(i.paneId):e.jsxs(Ln,{direction:i.direction,initialSize:i.size,onResize:g=>jt(i,g),children:[Fe(i.children[0]),Fe(i.children[1])]}),$t=i=>{const g=p[i];if(!g)return e.jsx("div",{className:"muted",children:"Pane not found"});const m=g.files,N=g.activeFile||"",$=b=>{if(I(i),R(D=>{const M=D[i];return M?(b&&!b.startsWith("shell-")&&b.includes("."),{...D,[i]:{...M,activeFile:b}}):D}),b&&!b.startsWith("shell-")){const D=b.split("/").filter(Boolean);D.pop(),D.length&&`${D.join("/")}`}A(b),se(Date.now())},F=b=>{R(D=>{const M=D[i];if(!M)return D;const ie=M.files.filter($e=>$e!==b);let ue=M.activeFile;return M.activeFile===b&&(ue=ie[0]||null),{...D,[i]:{...M,files:ie,activeFile:ue}}})},q={};for(const b of m)if(b.startsWith("shell-")){const M=(ge[b]||""||"/").split("/").filter(Boolean);let ie="/";if(M.length){const ue=M[M.length-1];ue.includes(".")&&M.length>1?ie=M[M.length-2]:ie=ue}q[b]=ie}else{const D=b.split("/").pop()||b;q[b]=vt[b]?`*${D}`:D}const Oe={},Ae={};for(const b of m)b.startsWith("shell-")?(Oe[b]="shell",Ae[b]=ge[b]||"/"):(Oe[b]="file",Ae[b]=b);const st=i===S;return e.jsxs("div",{className:"pane-content",style:{height:"100%",display:"flex",flexDirection:"column",position:"relative"},onClick:()=>{st||I(i)},children:[st&&e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:2,background:"var(--accent)",zIndex:10}}),m.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{onContextMenu:b=>{b.preventDefault()},children:e.jsx(o.Suspense,{fallback:null,children:e.jsx(bn,{openFiles:m,active:N,titles:q,fullPaths:Ae,types:Oe,onRestoreEvicted:()=>{},onActivate:$,onClose:F,onCloseOthers:b=>{R(D=>{const M=D[i];if(!M)return D;const ie=M.files.filter(ue=>ue===b);return{...D,[i]:{...M,files:ie,activeFile:b}}})},onCloseLeft:b=>{R(D=>{const M=D[i];if(!M)return D;const ie=M.files.indexOf(b);if(ie<=0)return D;const ue=M.files.slice(ie);let $e=M.activeFile;return ue.includes($e||"")||($e=b),{...D,[i]:{...M,files:ue,activeFile:$e}}})}})})}),e.jsx("div",{style:{flex:1,position:"relative"},children:m.map(b=>e.jsx("div",{style:{display:b===N?"block":"none",height:"100%"},children:b.startsWith("shell-")?e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"muted",children:t("loading")}),children:e.jsx(En,{shell:Ie&&Ie.defaultShell||"bash",path:ge[b]||"",onExit:()=>F(b)},b)}):b==="trash"?e.jsx(Jt,{}):b==="binary"?e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"muted",children:"Loadingâ€¦"}),children:e.jsx(wn,{path:_e||void 0})}):e.jsx(vn,{path:b,settings:Ie||void 0,onSaved:()=>{},reloadTrigger:_t[b]||0,onUnsavedChange:bt,onMeta:D=>{D&&D.path&&Ze(M=>({...M,[b]:D}))}})},b))})]}):e.jsxs("div",{className:"welcome-message",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"10px",opacity:.2},children:e.jsx(z,{name:O("folder"),size:48})}),e.jsx("div",{style:{opacity:.5},children:t("no_files")}),i!=="root"&&e.jsxs("button",{className:"btn link",onClick:()=>et(i),children:[t("close")," Pane"]})]})]})};return e.jsxs("div",{className:"app",children:[e.jsxs("header",{className:"app-header",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("img",{src:"/logo.png",alt:"MLCRemote logo",style:{height:28,display:"block"},onLoad:()=>ce(!0),onError:()=>ce(!1)}),!le&&e.jsx("h1",{style:{margin:0},children:"MLCRemote"})]}),e.jsxs("div",{className:"status",children:[e.jsx("button",{className:"link icon-btn",onClick:async()=>{var N;let i=y||"";try{if(i){const $=await xe(i);if(!$.isDir&&$.path){const F=$.path.split("/").filter(Boolean);F.pop(),i=F.length?`/${F.join("/")}`:""}}else if(X&&!X.startsWith("shell-"))try{const $=await xe(X);if($.isDir)i=$.path||X;else if($.path){const F=$.path.split("/").filter(Boolean);F.pop(),i=F.length?`/${F.join("/")}`:""}}catch{const F=X.split("/").filter(Boolean);F.pop(),i=F.length?`/${F.join("/")}`:""}}catch{}const g=`shell-${Date.now()}`;let m=i||"";if(m&&((N=m.split("/").pop())!=null&&N.includes("."))){const $=m.split("/").filter(Boolean);$.pop(),m=$.length?`/${$.join("/")}`:"/"}ze($=>({...$,[g]:m})),Y(g)},title:t("terminal"),"aria-label":t("terminal"),children:e.jsx(z,{name:O("terminal"),title:t("terminal"),size:16})}),e.jsx("button",{className:"link icon-btn","aria-label":"Toggle theme",onClick:()=>{const i=Te==="dark"?"light":"dark";xt(i),te.set("theme",i,Be),i==="light"?document.documentElement.classList.add("theme-light"):document.documentElement.classList.remove("theme-light")},children:Te==="dark"?e.jsx(z,{name:O("moon"),title:t("theme"),size:16}):e.jsx(z,{name:O("sun"),title:t("theme"),size:16})}),e.jsx("button",{className:"link icon-btn",title:t("about"),"aria-label":t("about"),onClick:()=>De(!0),children:e.jsx(z,{name:O("info"),title:t("about"),size:16})}),e.jsx("button",{className:"link icon-btn",title:"Screenshot","aria-label":"Screenshot",onClick:async()=>{const i=document.querySelector(".app");if(i)try{await $n(i,"mlcremote-screenshot.png")}catch(g){console.error("Screenshot failed",g)}},children:e.jsx(z,{name:O("screenshot"),title:"Screenshot",size:16})}),e.jsx("button",{className:"link icon-btn",title:"Trash","aria-label":"Trash",onClick:()=>{V.includes("trash")||Y("trash"),Q("trash")},children:e.jsx(z,{name:"icon-trash",title:"Trash",size:16})}),e.jsx("button",{className:"link icon-btn",title:"Split Right","aria-label":"Split Right",onClick:()=>Qe("vertical"),children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",style:{display:"block"},children:[e.jsx("path",{fillRule:"evenodd",d:"M14 3H2a1 1 0 00-1 1v8a1 1 0 001 1h12a1 1 0 001-1V4a1 1 0 00-1-1zM2 2a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H2z",clipRule:"evenodd"}),e.jsx("path",{d:"M8 4v8H7V4h1z"})]})}),e.jsx("button",{className:"link icon-btn",title:"Split Down","aria-label":"Split Down",onClick:()=>Qe("horizontal"),children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",style:{display:"block"},children:[e.jsx("path",{fillRule:"evenodd",d:"M14 3H2a1 1 0 00-1 1v8a1 1 0 001 1h12a1 1 0 001-1V4a1 1 0 00-1-1zM2 2a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H2z",clipRule:"evenodd"}),e.jsx("path",{d:"M2 8h12v1H2V8z"})]})}),w.type!=="leaf"&&e.jsx("button",{className:"link icon-btn",title:"Close Active Pane","aria-label":"Close Active Pane",onClick:()=>et(S),style:{marginLeft:4},children:e.jsx(z,{name:O("close"),size:16})}),e.jsx("button",{className:"link icon-btn","aria-label":t("settings"),title:t("settings"),onClick:()=>Ke(i=>!i),children:e.jsx(z,{name:O("settings"),title:t("settings"),size:16})})]}),mt&&e.jsx(Yt,{autoOpen:C,showHidden:E,onToggleAutoOpen:i=>H(i),onToggleShowHidden:i=>ee(i),showLogs:je,onToggleLogs:i=>{Ne(i),te.set("showLogs",i,he)},hideMemoryUsage:Ge,onToggleHideMemoryUsage:i=>{pt(i),te.set("hideMemoryUsage",i,he)},onClose:()=>Ke(!1)})]}),e.jsxs("div",{className:"app-body",style:{alignItems:"stretch"},children:[e.jsx("aside",{className:"sidebar",style:{width:Ye},children:e.jsx(Xt,{showHidden:E,autoOpen:C,onToggleHidden:i=>ee(i),selectedPath:y,activeDir:G,onDirChange:B,focusRequest:pe,reloadSignal:_,onSelect:(i,g)=>{if(A(i),g){Q(i);return}(async()=>{try{const m=await xe(i),N=He({path:i,meta:m});if(N.name==="Binary"||N.name==="Unsupported"){V.includes("binary")||Y("binary"),d(i),Q("binary");return}}catch(m){Je({title:"Broken Link",message:`Cannot open file: ${m.message||"stat failed"}`});return}C?Y(i):Q(i)})(),Pe()},onView:i=>{V.includes(i)?Q(i):Y(i),A(i),Pe()},onBackendActive:Pe,onChangeRoot:async()=>{if(!fe){alert("Changing root is not permitted by the server settings");return}const i=window.prompt("Enter the server directory path to use as new root (e.g. /home/user/project):",y||"/");if(!i)return;const g=i.trim();try{if(!(await xe(g)).isDir){alert("Selected path is not a directory");return}A(g);try{te.set("lastRoot",g,Be)}catch{}try{const N=te.getOrDefault("showHidden",he,!1);te.set("showHidden",N,he)}catch{}}catch(m){alert("Cannot access selected path: "+((m==null?void 0:m.message)||m))}}})}),e.jsx("div",{className:"resizer",onMouseDown:i=>{const g=i.clientX,m=Ye;function N(F){const q=F.clientX-g;gt(Math.max(160,Math.min(800,m+q)))}function $(){window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",$)}window.addEventListener("mousemove",N),window.addEventListener("mouseup",$)},children:e.jsx("div",{className:"bar"})}),e.jsx("main",{className:"main",children:e.jsxs("div",{className:"main-content",children:[P&&e.jsx("div",{className:"login-overlay",children:e.jsxs("div",{className:"login-box",children:[e.jsx("h3",{children:"Not Authenticated"}),e.jsx("p",{children:"You need to sign in or provide an access key to continue."}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsxs("button",{className:"btn",onClick:()=>{x(!1),f(!0)},children:[t("open")," (password)"]}),e.jsx("button",{className:"btn",onClick:()=>{x(!1),k(!0)},children:"I have an access key"})]})]})}),u&&e.jsx("div",{className:"login-overlay",children:e.jsxs("div",{className:"login-box",children:[e.jsx("h3",{children:"Sign in"}),e.jsx("p",{children:"Please enter the server password to obtain an access token."}),e.jsx("input",{id:"mlc-login-pwd",type:"password",placeholder:"Password"}),e.jsx("div",{style:{marginTop:8},children:e.jsx("button",{className:"btn",onClick:async()=>{const i=document.getElementById("mlc-login-pwd");if(i)try{await h(i.value)}catch(g){alert("Login failed: "+((g==null?void 0:g.message)||g))}},children:t("open")})})]})}),v&&e.jsx("div",{className:"login-overlay",children:e.jsxs("div",{className:"login-box",children:[e.jsx("h3",{children:"Enter Access Token"}),e.jsx("p",{children:"The server requires an access token. Paste it here to continue."}),e.jsx("input",{id:"mlc-token-input",type:"text",placeholder:"token"}),e.jsx("div",{style:{marginTop:8},children:e.jsx("button",{className:"btn",onClick:async()=>{const i=document.getElementById("mlc-token-input");if(i)try{l(i.value.trim())}catch(g){alert("Failed to store token: "+((g==null?void 0:g.message)||g))}},children:"Use token"})})]})}),Me&&e.jsx(Sn,{title:Me.title,message:Me.message,onClose:()=>Je(null)}),Fe(w)]})})]}),e.jsx(Cn,{health:n,isOnline:s,hideMemoryUsage:Ge,lastHealthAt:r}),e.jsx(jn,{visible:je,onClose:()=>Ne(!1)}),ft&&e.jsx("div",{className:"about-backdrop",onClick:()=>De(!1),children:e.jsxs("div",{className:"about-modal",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0},children:"MLCRemote"}),e.jsx("button",{"aria-label":t("close"),title:t("close"),onClick:()=>De(!1),style:{background:"transparent",border:"none",cursor:"pointer"},children:e.jsx(z,{name:"icon-close",size:16})})]}),e.jsxs("div",{style:{marginBottom:8},children:["Copyright Â© ",new Date().getFullYear()," Michael Lechner"]}),e.jsxs("div",{style:{marginBottom:8},children:["Version: ",n?`${n.status}@${n.version}`:"unknown"]}),n&&e.jsxs("div",{style:{maxHeight:"40vh",overflow:"auto",background:"#0b0b0b",color:"white",padding:12,borderRadius:6},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Host:"})," ",n.host]}),e.jsxs("div",{children:[e.jsx("strong",{children:"PID:"})," ",n.pid]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Version:"})," ",n.version]}),e.jsxs("div",{children:[e.jsx("strong",{children:"App Memory:"})," ",me(n.go_alloc_bytes)," (alloc) / ",me(n.go_sys_bytes)," (sys)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"System Memory:"})," ",me((n.sys_mem_total_bytes||0)-(n.sys_mem_free_bytes||0))," / ",me(n.sys_mem_total_bytes||0)," used"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"CPU:"})," ",Math.round((n.cpu_percent||0)*10)/10,"%"]}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("strong",{children:"Server time:"})," ",n.server_time]}),e.jsxs("div",{style:{marginTop:4},children:[e.jsx("strong",{children:"Timezone:"})," ",n.timezone]}),e.jsxs("div",{className:"muted",style:{marginTop:8,fontSize:12},children:["Last refresh: ",r?new Date(r).toLocaleString():"n/a"]})]})]})})]})}const Tn="MLCRemote IDE",Rn="Files",zn="Terminal",Dn="Settings",In="Search",Mn="New File",Pn="New Folder",Fn="Rename",On="Save",An="Cancel",Bn="Theme",Wn="Language",Hn="Editor",Un="Run",Vn="Debug",qn="Close",Kn="Open",Gn="Loading...",Xn="No files open",Yn="Switch to Remote View",Jn="Disconnected from server",Zn="Refresh",Qn="Change Root",es="Upload",ts="Download",ns="Copy Full Path",ss="Copy Relative Path",os="Copy Name",rs="Are you sure you want to delete {{path}}?",is="Auto open files",as="Show hidden files",ls="Show server logs",cs="Hide memory usage gauge",ds="About MLCRemote",us="Version",hs="Copyright",fs="Drop to upload",ms="View file",ps="Loading trash...",gs="Trash is empty",xs="Original path",ys="Trash path",_s="Undo (coming)",vs="Connected to shell session: {{id}}",ws="Connected to ephemeral shell",bs="Copy",js="Paste",$s="Paste text here",ks="Logs",Ss="Clear",Cs="Loading PDF support...",Ls="Loading PDF...",Es="Prev",Ns="Next",Ts="No preview",Rs="No file selected",zs="Full path",Ds="MIME",Is="Size",Ms="Mode",Ps="Last Modified",Fs="Is Dir",Os="Yes",As="No",Bs="Loading metadata...",Ws="Open or create a file to edit",Hs="Close Others",Us="Close Left",Vs="Restore",qs="scroll left",Ks="scroll right",Gs={app_title:Tn,files:Rn,terminal:zn,settings:Dn,search:In,new_file:Mn,new_folder:Pn,rename:Fn,delete:"Delete",save:On,cancel:An,theme:Bn,language:Wn,editor:Hn,run:Un,debug:Vn,close:qn,open:Kn,loading:Gn,no_files:Xn,switch_to_remote:Yn,disconnected:Jn,refresh:Zn,change_root:Qn,upload:es,download:ts,copy_full_path:ns,copy_relative_path:ss,copy_name:os,delete_confirm:rs,auto_open_files:is,show_hidden_files:as,show_server_logs:ls,hide_memory_usage:cs,about:ds,version:us,copyright:hs,drop_to_upload:fs,view_file:ms,loading_trash:ps,trash_empty:gs,original_path:xs,trash_path:ys,undo_coming:_s,terminal_connected_session:vs,terminal_connected_ephemeral:ws,copy:bs,paste:js,paste_text_here:$s,logs:ks,clear:Ss,loading_pdf_support:Cs,loading_pdf:Ls,previous:Es,next:Ns,no_preview:Ts,no_file_selected:Rs,full_path:zs,mime:Ds,size:Is,mode:Ms,last_modified:Ps,is_dir:Fs,yes:Os,no:As,loading_metadata:Bs,open_or_create_file:Ws,close_others:Hs,close_left:Us,restore:Vs,scroll_left:qs,scroll_right:Ks},Xs="MLCRemote IDE",Ys="Dateien",Js="Terminal",Zs="Einstellungen",Qs="Suchen",eo="Neue Datei",to="Neuer Ordner",no="Umbenennen",so="Speichern",oo="Abbrechen",ro="Design",io="Sprache",ao="Editor",lo="AusfÃ¼hren",co="Debuggen",uo="SchlieÃŸen",ho="Ã–ffnen",fo="Laden...",mo="Keine Dateien geÃ¶ffnet",po="Zur Remote-Ansicht wechseln",go="Vom Server getrennt",xo="Aktualisieren",yo="Wurzelverzeichnis Ã¤ndern",_o="Hochladen",vo="Herunterladen",wo="VollstÃ¤ndigen Pfad kopieren",bo="Relativen Pfad kopieren",jo="Namen kopieren",$o="Sind Sie sicher, dass Sie {{path}} lÃ¶schen mÃ¶chten?",ko="Dateien automatisch Ã¶ffnen",So="Versteckte Dateien anzeigen",Co="Server-Logs anzeigen",Lo="Speicherauslastung ausblenden",Eo="Ãœber MLCRemote",No="Version",To="Urheberrecht",Ro="Zum Hochladen hier ablegen",zo="Datei anzeigen",Do="Papierkorb wird geladen...",Io="Papierkorb ist leer",Mo="UrsprÃ¼nglicher Pfad",Po="Papierkorb-Pfad",Fo="RÃ¼ckgÃ¤ngig (demnÃ¤chst)",Oo="Verbunden mit Shell-Sitzung: {{id}}",Ao="Verbunden mit temporÃ¤rer Shell",Bo="Kopieren",Wo="EinfÃ¼gen",Ho="Text hier einfÃ¼gen",Uo="Protokolle",Vo="LÃ¶schen",qo="PDF-UnterstÃ¼tzung wird geladen...",Ko="PDF wird geladen...",Go="ZurÃ¼ck",Xo="Weiter",Yo="Keine Vorschau",Jo="Keine Datei ausgewÃ¤hlt",Zo="VollstÃ¤ndiger Pfad",Qo="MIME-Typ",er="GrÃ¶ÃŸe",tr="Modus",nr="Zuletzt geÃ¤ndert",sr="Ist Verzeichnis",or="Ja",rr="Nein",ir="Metadaten werden geladen...",ar="Ã–ffnen oder erstellen Sie eine Datei zum Bearbeiten",lr="Andere schlieÃŸen",cr="Links schlieÃŸen",dr="Wiederherstellen",ur="nach links scrollen",hr="nach rechts scrollen",fr={app_title:Xs,files:Ys,terminal:Js,settings:Zs,search:Qs,new_file:eo,new_folder:to,rename:no,delete:"LÃ¶schen",save:so,cancel:oo,theme:ro,language:io,editor:ao,run:lo,debug:co,close:uo,open:ho,loading:fo,no_files:mo,switch_to_remote:po,disconnected:go,refresh:xo,change_root:yo,upload:_o,download:vo,copy_full_path:wo,copy_relative_path:bo,copy_name:jo,delete_confirm:$o,auto_open_files:ko,show_hidden_files:So,show_server_logs:Co,hide_memory_usage:Lo,about:Eo,version:No,copyright:To,drop_to_upload:Ro,view_file:zo,loading_trash:Do,trash_empty:Io,original_path:Mo,trash_path:Po,undo_coming:Fo,terminal_connected_session:Oo,terminal_connected_ephemeral:Ao,copy:Bo,paste:Wo,paste_text_here:Ho,logs:Uo,clear:Vo,loading_pdf_support:qo,loading_pdf:Ko,previous:Go,next:Xo,no_preview:Yo,no_file_selected:Jo,full_path:Zo,mime:Qo,size:er,mode:tr,last_modified:nr,is_dir:sr,yes:or,no:rr,loading_metadata:ir,open_or_create_file:ar,close_others:lr,close_left:cr,restore:dr,scroll_left:ur,scroll_right:hr},mr="MLCRemote IDE",pr="Archivos",gr="Terminal",xr="ConfiguraciÃ³n",yr="Buscar",_r="Nuevo Archivo",vr="Nueva Carpeta",wr="Renombrar",br="Guardar",jr="Cancelar",$r="Tema",kr="Idioma",Sr="Editor",Cr="Ejecutar",Lr="Depurar",Er="Cerrar",Nr="Abrir",Tr="Cargando...",Rr="No hay archivos abiertos",zr="Cambiar a vista remota",Dr="Desconectado del servidor",Ir="Actualizar",Mr="Cambiar raÃ­z",Pr="Subir",Fr="Descargar",Or="Copiar ruta completa",Ar="Copiar ruta relativa",Br="Copiar nombre",Wr="Â¿EstÃ¡s seguro de que deseas eliminar {{path}}?",Hr="Abrir archivos automÃ¡ticamente",Ur="Mostrar archivos ocultos",Vr="Mostrar logs del servidor",qr="Ocultar uso de memoria",Kr="Acerca de MLCRemote",Gr="VersiÃ³n",Xr="Derechos de autor",Yr="Soltar para subir",Jr="Ver archivo",Zr="Cargando papelera...",Qr="La papelera estÃ¡ vacÃ­a",ei="Ruta original",ti="Ruta de la papelera",ni="Deshacer (prÃ³ximamente)",si="Conectado a la sesiÃ³n de shell: {{id}}",oi="Conectado a la shell efÃ­mera",ri="Copiar",ii="Pegar",ai="Pegar texto aquÃ­",li="Registros",ci="Limpiar",di="Cargando soporte PDF...",ui="Cargando PDF...",hi="Ant",fi="Sig",mi="Sin vista previa",pi="NingÃºn archivo seleccionado",gi="Ruta completa",xi="MIME",yi="TamaÃ±o",_i="Modo",vi="Ãšltima modificaciÃ³n",wi="Es directorio",bi="SÃ­",ji="No",$i="Cargando metadatos...",ki="Abrir o crear un archivo para editar",Si="Cerrar otros",Ci="Cerrar izquierda",Li="Restaurar",Ei="desplazarse a la izquierda",Ni="desplazarse a la derecha",Ti={app_title:mr,files:pr,terminal:gr,settings:xr,search:yr,new_file:_r,new_folder:vr,rename:wr,delete:"Eliminar",save:br,cancel:jr,theme:$r,language:kr,editor:Sr,run:Cr,debug:Lr,close:Er,open:Nr,loading:Tr,no_files:Rr,switch_to_remote:zr,disconnected:Dr,refresh:Ir,change_root:Mr,upload:Pr,download:Fr,copy_full_path:Or,copy_relative_path:Ar,copy_name:Br,delete_confirm:Wr,auto_open_files:Hr,show_hidden_files:Ur,show_server_logs:Vr,hide_memory_usage:qr,about:Kr,version:Gr,copyright:Xr,drop_to_upload:Yr,view_file:Jr,loading_trash:Zr,trash_empty:Qr,original_path:ei,trash_path:ti,undo_coming:ni,terminal_connected_session:si,terminal_connected_ephemeral:oi,copy:ri,paste:ii,paste_text_here:ai,logs:li,clear:ci,loading_pdf_support:di,loading_pdf:ui,previous:hi,next:fi,no_preview:mi,no_file_selected:pi,full_path:gi,mime:xi,size:yi,mode:_i,last_modified:vi,is_dir:wi,yes:bi,no:ji,loading_metadata:$i,open_or_create_file:ki,close_others:Si,close_left:Ci,restore:Li,scroll_left:Ei,scroll_right:Ni},Ri="MLCRemote IDE",zi="Fichiers",Di="Terminal",Ii="ParamÃ¨tres",Mi="Rechercher",Pi="Nouveau Fichier",Fi="Nouveau Dossier",Oi="Renommer",Ai="Enregistrer",Bi="Annuler",Wi="ThÃ¨me",Hi="Langue",Ui="Ã‰diteur",Vi="ExÃ©cuter",qi="DÃ©boguer",Ki="Fermer",Gi="Ouvrir",Xi="Chargement...",Yi="Aucun fichier ouvert",Ji="Passer Ã  la vue distante",Zi="DÃ©connectÃ© du serveur",Qi="Actualiser",ea="Changer la racine",ta="TÃ©lÃ©verser",na="TÃ©lÃ©charger",sa="Copier le chemin complet",oa="Copiar le chemin relatif",ra="Copier le nom",ia="ÃŠtes-vous sÃ»r de vouloir supprimer {{path}} ?",aa="Ouvrir les fichiers automatiquement",la="Afficher les fichiers cachÃ©s",ca="Afficher les logs du serveur",da="Masquer l'utilisation de la mÃ©moire",ua="Ã€ propos de MLCRemote",ha="Version",fa="Copyright",ma="DÃ©poser pour tÃ©lÃ©verser",pa="Voir le fichier",ga="Chargement de la corbeille...",xa="La corbeille est vide",ya="Chemin d'origine",_a="Chemin de la corbeille",va="Annuler (prochainement)",wa="ConnectÃ© Ã  la session shell : {{id}}",ba="ConnectÃ© au shell Ã©phÃ©mÃ¨re",ja="Copier",$a="Coller",ka="Coller le texte ici",Sa="Journaux",Ca="Effacer",La="Chargement du support PDF...",Ea="Chargement du PDF...",Na="PrÃ©c",Ta="Suiv",Ra="Pas d'aperÃ§u",za="Aucun fichier sÃ©lectionnÃ©",Da="Chemin complet",Ia="MIME",Ma="Taille",Pa="Mode",Fa="DerniÃ¨re modification",Oa="Est un rÃ©pertoire",Aa="Oui",Ba="Non",Wa="Chargement des mÃ©tadatos...",Ha="Ouvrir ou crÃ©er un fichier Ã  Ã©diter",Ua="Fermer les autres",Va="Fermer Ã  gauche",qa="Restaurer",Ka="faire dÃ©filer vers la gauche",Ga="faire dÃ©filer vers la droite",Xa={app_title:Ri,files:zi,terminal:Di,settings:Ii,search:Mi,new_file:Pi,new_folder:Fi,rename:Oi,delete:"Supprimer",save:Ai,cancel:Bi,theme:Wi,language:Hi,editor:Ui,run:Vi,debug:qi,close:Ki,open:Gi,loading:Xi,no_files:Yi,switch_to_remote:Ji,disconnected:Zi,refresh:Qi,change_root:ea,upload:ta,download:na,copy_full_path:sa,copy_relative_path:oa,copy_name:ra,delete_confirm:ia,auto_open_files:aa,show_hidden_files:la,show_server_logs:ca,hide_memory_usage:da,about:ua,version:ha,copyright:fa,drop_to_upload:ma,view_file:pa,loading_trash:ga,trash_empty:xa,original_path:ya,trash_path:_a,undo_coming:va,terminal_connected_session:wa,terminal_connected_ephemeral:ba,copy:ja,paste:$a,paste_text_here:ka,logs:Sa,clear:Ca,loading_pdf_support:La,loading_pdf:Ea,previous:Na,next:Ta,no_preview:Ra,no_file_selected:za,full_path:Da,mime:Ia,size:Ma,mode:Pa,last_modified:Fa,is_dir:Oa,yes:Aa,no:Ba,loading_metadata:Wa,open_or_create_file:Ha,close_others:Ua,close_left:Va,restore:qa,scroll_left:Ka,scroll_right:Ga};Nt.use(Tt).use(Ct).init({resources:{en:{translation:Gs},de:{translation:fr},es:{translation:Ti},fr:{translation:Xa}},fallbackLng:"en",interpolation:{escapeValue:!1}});console.log("MLCRemote: captureTokenFromURL type:",typeof We);try{typeof We=="function"?We():console.error("MLCRemote: captureTokenFromURL is not a function!")}catch(t){console.error("MLCRemote: Initialization error",t)}(async()=>{try{const t=await Re(()=>import("./icons-sprite-C094kis_.js"),[],import.meta.url),n=t&&(t.default||t);if(n&&typeof document<"u"){const s=document.createElement("div");s.style.width="0",s.style.height="0",s.style.position="absolute",s.style.visibility="hidden",s.innerHTML=n,document.body.insertBefore(s,document.body.firstChild)}}catch(t){alert("Failed to load icon sprite: "+((t==null?void 0:t.message)||t))}})();Lt(document.getElementById("root")).render(e.jsx(Vt,{children:e.jsx(Nn,{})}));export{Re as _,ae as a,cl as g,Ee as m,xe as s};
