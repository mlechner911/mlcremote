const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PdfPreview-BcfZ5AQn.js","./vendor-react-DgaSUS5F.js","./vendor-scheduler-DYLXRpC5.js","./vendor-prism-D73ALYcd.js","./vendor-prism-Cg1sXqY3.css","./vendor-html2canvas-BfYXEYrK.js","./vendor-xterm-DOcMqDAd.js","./vendor-xterm-DYP7pi_n.css","./vendor-i18next-BnqEsHlA.js","./vendor-i18next-browser-languagedetector-ClvlpAgo.js","./ShellView-C5F6kzw9.js","./TerminalTab-B7QhccUl.js"])))=>i.map(i=>d[i]);
var Ft=Object.defineProperty;var At=(t,n,s)=>n in t?Ft(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s;var ht=(t,n,s)=>At(t,typeof n!="symbol"?n+"":n,s);import{r as G,R as i,j as e,u as Q,i as Bt,c as Ht}from"./vendor-react-DgaSUS5F.js";import{P as Ke}from"./vendor-prism-D73ALYcd.js";import{h as Ut}from"./vendor-html2canvas-BfYXEYrK.js";import"./vendor-xterm-DOcMqDAd.js";import{i as yt}from"./vendor-i18next-BnqEsHlA.js";import{B as Wt}from"./vendor-i18next-browser-languagedetector-ClvlpAgo.js";import"./vendor-scheduler-DYLXRpC5.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const m of a)if(m.type==="childList")for(const c of m.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(a){const m={};return a.integrity&&(m.integrity=a.integrity),a.referrerPolicy&&(m.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?m.credentials="include":a.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function o(a){if(a.ep)return;a.ep=!0;const m=s(a);fetch(a.href,m)}})();const Vt="modulepreload",qt=function(t,n){return new URL(t,n).href},mt={},Ie=function(n,s,o){let a=Promise.resolve();if(s&&s.length>0){const c=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(s.map(f=>{if(f=qt(f,o),f in mt)return;mt[f]=!0;const j=f.endsWith(".css"),$=j?'[rel="stylesheet"]':"";if(!!o)for(let w=c.length-1;w>=0;w--){const z=c[w];if(z.href===f&&(!j||z.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${$}`))return;const x=document.createElement("link");if(x.rel=j?"stylesheet":Vt,j||(x.as="script"),x.crossOrigin="",x.href=f,h&&x.setAttribute("nonce",h),document.head.appendChild(x),j)return new Promise((w,z)=>{x.addEventListener("load",w),x.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${f}`)))})}))}function m(c){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=c,window.dispatchEvent(l),!l.defaultPrevented)throw c}return a.then(c=>{for(const l of c||[])l.status==="rejected"&&m(l.reason);return n().catch(m)})},Yt=200,Ce=[],Le=[];function _t(t,n){const s={ts:new Date().toISOString(),level:t,msg:n};for(Ce.push(s);Ce.length>Yt;)Ce.shift();Le.forEach(o=>o())}function X(t){_t("info",t)}function Ne(t){_t("warn",t)}function Gt(){return Ce.slice().reverse()}function Kt(t){return Le.push(t),()=>{const n=Le.indexOf(t);n>=0&&Le.splice(n,1)}}function Xt(){Ce.length=0,Le.forEach(t=>t())}function Xe(){try{return localStorage.getItem("mlcremote_token")}catch{return null}}function qe(t){try{localStorage.setItem("mlcremote_token",t)}catch{}}let we="";function ft(t){we=t.replace(/\/$/,"")}function zl(){return we}function be(t){if(!we||typeof t!="string"||t.startsWith("http"))return t;if(we.includes("?")){const[n,s]=we.split("?"),o=`${n.replace(/\/$/,"")}${t}`;return o.includes("?")?`${o}&${s}`:`${o}?${s}`}return`${we}${t}`}async function oe(t,n){const s=Xe(),o=new Headers(n==null?void 0:n.headers);s&&o.set("X-Auth-Token",s);const a={...n||{},headers:o};let m=t;typeof t=="string"&&t.startsWith("/")&&(m=be(t));const c=await fetch(m,a);if(c.status===401){try{localStorage.removeItem("mlcremote_token")}catch{}try{window.dispatchEvent(new CustomEvent("mlcremote:auth-failed",{detail:{url:typeof t=="string"?t:t.url}}))}catch{}}return c}async function Jt(t){X("POST /api/login");const n=await fetch(be("/api/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t})});if(X(`/api/login => ${n.status}`),!n.ok)throw new Error("login failed");const s=await n.json();if(s&&s.token)return qe(s.token),s.token;throw new Error("no token in response")}async function Zt(){X("GET /health");const t=await oe("/health");if(X(`/health => ${t.status}`),!t.ok)throw Ne("/health not ok"),new Error("health failed");return t.json()}function Ye(){try{const t=new URLSearchParams(window.location.search),n=t.get("token");n&&qe(n);const s=t.get("api");if(s){X(`[Debug] Found API param: ${s}`);try{const o=new URL(s);let a=o.origin+o.pathname;a.endsWith("/")&&(a=a.slice(0,-1)),X(`[Debug] Setting Base URL: ${a}`),ft(a);const m=o.searchParams.get("token");m&&qe(m)}catch(o){console.error("Failed to parse API URL",o),ft(s)}}else X("[Debug] No API param found");return!!n}catch{}return!1}async function Qt(){try{return(await oe("/api/auth/check")).status===200}catch{return!1}}async function vt(t="",n){const s=new URLSearchParams;t&&s.set("path",t),n!=null&&n.showHidden&&s.set("showHidden","1");const o=s.toString()?`?${s.toString()}`:"";X(`GET /api/tree${o}`);const a=await oe(`/api/tree${o}`);if(X(`/api/tree${o} => ${a.status}`),!a.ok)throw Ne("/api/tree not ok"),new Error("tree failed");return a.json()}async function en(t){X(`GET /api/file?path=${t}`);const n=await oe(`/api/file?path=${encodeURIComponent(t)}`);if(X(`/api/file?path=${t} => ${n.status}`),!n.ok)throw Ne("/api/file read failed"),new Error("read failed");return n.text()}async function fe(t){X(`GET /api/stat?path=${t}`);const n=await oe(`/api/stat?path=${encodeURIComponent(t)}`);if(X(`/api/stat?path=${t} => ${n.status}`),!n.ok)throw new Error("stat failed");return n.json()}async function tn(t,n){X(`POST /api/file path=${t} size=${n.length}`);const s=await oe("/api/file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t,content:n})});if(X(`/api/file POST => ${s.status}`),!s.ok)throw Ne("/api/file save failed"),new Error("save failed")}async function nn(t){X(`DELETE /api/file?path=${t}`);const n=await oe(`/api/file?path=${encodeURIComponent(t)}`,{method:"DELETE"});if(X(`/api/file delete => ${n.status}`),!n.ok)throw Ne("/api/file delete failed"),new Error("delete failed")}async function sn(){const t=await oe("/api/settings");if(!t.ok)throw new Error("Failed to load settings");return t.json()}async function me(t){const n=await oe("/api/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to save settings");return n.json()}const wt=G.createContext(null);function on({children:t}){const[n,s]=G.useState(null),[o,a]=G.useState(null),[m,c]=G.useState(navigator.onLine),[l,h]=G.useState(!1),[f,j]=G.useState(!1),[$,L]=G.useState(!1);i.useState(()=>{if(typeof window>"u")return;const S=new URLSearchParams(window.location.search).get("token");if(S){console.log("[Auth] Token found in URL (sync init):",S),localStorage.setItem("mlcremote_token",S);const O=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState({path:O},"",O)}});const x=G.useCallback(async()=>{if(navigator.onLine)try{const b=await Zt();s(b),a(Date.now()),await Qt()||(localStorage.removeItem("mlcremote_token"),b.password_auth?h(!0):b.auth_required&&j(!0))}catch{s(null)}},[]);G.useEffect(()=>{const b=()=>{c(!0),x()},S=()=>{c(!1),s(null)};window.addEventListener("online",b),window.addEventListener("offline",S);const O=setInterval(x,60*1e3);x();const K=()=>L(!0);return window.addEventListener("mlcremote:auth-failed",K),()=>{window.removeEventListener("online",b),window.removeEventListener("offline",S),window.removeEventListener("mlcremote:auth-failed",K),clearInterval(O)}},[x]),G.useEffect(()=>{if(!n){L(!1);return}const b=!!n.password_auth,S=!!n.auth_required&&!n.password_auth,O=localStorage.getItem("mlcremote_token");L(!!((b||S)&&!O))},[n]);const w=async b=>{await Jt(b),await x(),h(!1),L(!1)},z=b=>{localStorage.setItem("mlcremote_token",b),x(),j(!1),L(!1)},D=()=>{localStorage.removeItem("mlcremote_token"),x()};return e.jsx(wt.Provider,{value:{health:n,isOnline:m,lastHealthAt:o,refreshHealth:x,login:w,setToken:z,logout:D,showLogin:l,setShowLogin:h,showTokenInput:f,setShowTokenInput:j,showAuthChooser:$,setShowAuthChooser:L},children:t})}function rn(){const t=G.useContext(wt);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}const T=({name:t,className:n,title:s,size:o=16})=>{if(!t)return null;const a=`#${t}`;return e.jsxs("svg",{className:n,width:o,height:o,"aria-hidden":s?void 0:"true",role:s?"img":void 0,children:[s?e.jsx("title",{children:s}):null,e.jsx("use",{href:a})]})},an={moon:"icon-moon",markdown:"icon-markdown",png:"icon-image",jpg:"icon-image",txt:"icon-text",tar:"icon-archive",download:"icon-download",upload:"icon-upload",info:"icon-info",gz:"icon-archive",json:"icon-json",warn:"icon-warning",run:"icon-play",stop:"icon-stop",search:"icon-search",user:"icon-user",screenshot:"icon-screenshot",dir:"icon-folder",pdf:"icon-pdf",jpeg:"icon-image",gif:"icon-image",bz2:"icon-archive",shell:"icon-terminal",sun:"icon-sun",trash:"icon-trash",zip:"icon-archive",mjs:"icon-js",settings:"icon-settings",cl:"icon-chevron-left",svg:"icon-image",js:"icon-js",cfg:"icon-settings",close:"icon-close",cr:"icon-chevron-right",view:"icon-view",link:"icon-link","flag-de":"icon-flag-de",sh:"icon-terminal",refresh:"icon-refresh",plus:"icon-plus",minus:"icon-minus",log:"icon-log",copy:"icon-copy",md:"icon-markdown","flag-gb":"icon-flag-gb","flag-es":"icon-flag-es","flag-fr":"icon-flag-fr",x:"icon-close",home:"icon-home",up:"icon-up",server:"icon-server"};function pe(t){if(t)return an[t.toLowerCase()]}function bt(t,n){if(n){const s=n.lastIndexOf(".");if(s>=0&&s<n.length-1){const o=n.slice(s+1).toLowerCase();return pe(o)}}}const H=t=>"icon-"+t;function ln({x:t,y:n,items:s,onClose:o}){const a=i.useRef(null);i.useEffect(()=>{function l(h){a.current&&!a.current.contains(h.target)&&o()}return window.addEventListener("mousedown",l),window.addEventListener("scroll",o,!0),window.addEventListener("resize",o),()=>{window.removeEventListener("mousedown",l),window.removeEventListener("scroll",o,!0),window.removeEventListener("resize",o)}},[o]);const[m,c]=i.useState({x:t,y:n});return i.useLayoutEffect(()=>{if(a.current){const l=a.current.getBoundingClientRect();let h=t,f=n;h+l.width>window.innerWidth&&(h=window.innerWidth-l.width-8),f+l.height>window.innerHeight&&(f=window.innerHeight-l.height-8),c({x:h,y:f})}},[t,n]),e.jsx("div",{ref:a,style:{position:"fixed",left:m.x,top:m.y,background:"var(--panel)",border:"1px solid var(--border)",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",borderRadius:6,padding:4,zIndex:99999,minWidth:160,display:"flex",flexDirection:"column"},onContextMenu:l=>{l.preventDefault(),o()},children:s.map((l,h)=>l.separator?e.jsx("div",{style:{height:1,background:"var(--border)",margin:"4px 0"}},h):e.jsxs("button",{className:"context-menu-item",onClick:()=>{o(),l.action()},style:{display:"flex",alignItems:"center",gap:8,padding:"6px 10px",border:"none",background:"transparent",color:l.danger?"var(--danger)":"var(--text)",cursor:"pointer",textAlign:"left",borderRadius:4,fontSize:13},onMouseEnter:f=>f.currentTarget.style.background=l.danger?"rgba(239,68,68,0.1)":"var(--bg)",onMouseLeave:f=>f.currentTarget.style.background="transparent",children:[l.icon&&e.jsx("span",{style:{width:16,display:"flex"},children:l.icon}),l.label]},h))})}function cn({onSelect:t,showHidden:n,onToggleHidden:s,autoOpen:o=!0,onView:a,onBackendActive:m,onChangeRoot:c,canChangeRoot:l,selectedPath:h,activeDir:f,onDirChange:j,focusRequest:$,reloadSignal:L}){const{t:x}=Q(),[w,z]=i.useState(""),[D,b]=i.useState([]),[S,O]=i.useState(!1),[K,A]=i.useState(""),[ge,re]=i.useState(null),[ae,de]=i.useState(!1),[g,M]=i.useState(null),_=i.useCallback(async u=>{O(!0),A("");try{const k=await vt(u,{showHidden:n});b(k),z(u);try{U.current!==u&&(j==null||j(u),U.current=u)}catch{}m==null||m();try{const W=Z.current;W&&requestAnimationFrame(()=>{const q=he.current;if(q)try{const te=q.querySelector(`[data-path="${CSS.escape(W)}"]`);te&&(te.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"}),te.focus())}catch{}})}catch{}}catch(k){A(k.message||x("status_failed"))}finally{O(!1)}},[n,m,j,x]),U=i.useRef("");i.useEffect(()=>{typeof f>"u"||f!==w&&_(f)},[f,w,_]),i.useEffect(()=>{_("")},[_]),i.useEffect(()=>{_(w||"")},[w,_,L]);const P=()=>{if(!w||w==="/"){_("");return}const u=w.split("/").filter(Boolean);u.pop();const k=`/${u.join("/")}`;_(k||"")},N=async(u,k)=>{if(!(!k||k.length===0)&&(console.log("Dropping files:",k.length,"to",u),!!confirm(x("upload_confirm",`Upload ${k.length} file(s) to ${u}?`)))){de(!0),A("");try{const W=new FormData;for(let xe=0;xe<k.length;xe++)W.append("file",k[xe],k[xe].name);const q=`?path=${encodeURIComponent(u)}`;if(!(await oe(`/api/upload${q}`,{method:"POST",body:W})).ok)throw new Error(x("status_failed"));await _(u)}catch(W){A(W.message||x("status_failed"))}finally{de(!1)}}},V=(u,k)=>{u.preventDefault(),console.log("onDrop triggered",k),re(null),N(k,u.dataTransfer.files)},ee=(u,k)=>{u.preventDefault(),re(k)},J=u=>{u.preventDefault(),re(null)},he=i.useRef(null),Z=i.useRef("");i.useEffect(()=>{Z.current=h||""},[h]),i.useEffect(()=>{if(h)try{const u=he.current;if(!u)return;const k=u.querySelector(`li[key="${CSS.escape(h)}"]`),W=u.querySelector(`[data-path="${h}"]`),q=k||W;if(q){q.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"});const te=q.querySelector("button.entry");te&&te.focus()}}catch{}},[h,w]),i.useEffect(()=>{if($)try{const u=h||"";if(!u)return;const k=he.current;if(!k)return;const W=CSS.escape(u),q=k.querySelector(`[data-path="${W}"]`);q&&(q.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"}),q.focus())}catch{}},[$,h]);const ze=async u=>{if(confirm(x("delete_confirm",{path:u})))try{await nn(u),_(w)}catch(k){alert(x("status_failed")+": "+k.message)}},je=(u,k)=>{u.preventDefault(),u.stopPropagation(),M({x:u.clientX,y:u.clientY,item:k})};return e.jsxs("div",{className:"explorer",children:[e.jsxs("div",{className:"explorer-header",children:[e.jsx("strong",{className:"hidden",children:e.jsx(T,{name:H("dir")})}),e.jsxs("div",{className:"explorer-controls",children:[e.jsx("button",{className:"link icon-btn",title:x("refresh"),onClick:()=>_(w||""),children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M23 4v6h-6"}),e.jsx("path",{d:"M1 20v-6h6"}),e.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}),l&&typeof c=="function"&&e.jsx("button",{className:"link icon-btn","aria-label":x("change_root"),title:x("change_root"),onClick:async()=>{try{await Promise.resolve(c(""))}catch{}},children:e.jsx(T,{name:H("dir")})})]}),e.jsxs("div",{className:"breadcrumbs",children:[e.jsx("button",{type:"button",className:"link icon-btn",onClick:()=>_(""),title:"Server Root",children:e.jsx(T,{name:H("terminal"),size:14})}),w&&w.split("/").filter(Boolean).map((u,k,W)=>{const q=`/${W.slice(0,k+1).join("/")}`;return e.jsxs("span",{children:[" / ",e.jsx("button",{className:"link",onClick:()=>_(q),children:u})]},q)})]})]}),e.jsxs("div",{className:"explorer-body",onDrop:u=>V(u,w||""),onDragOver:u=>ee(u,w||""),onDragLeave:J,children:[S&&e.jsx("div",{className:"muted",children:x("loading")}),K&&e.jsx("div",{className:"error",children:K}),ae&&e.jsxs("div",{className:"muted",children:[x("upload"),"..."]}),!S&&!K&&e.jsxs("ul",{className:"entry-list",ref:he,children:[w&&w!=="/"&&e.jsx("li",{children:e.jsx("button",{type:"button",className:"entry",onClick:P,children:".."})},"up"),D.map(u=>e.jsx("li",{onContextMenu:k=>je(k,u),children:u.isDir?e.jsxs("button",{"data-path":u.path,type:"button",className:"entry"+(h===u.path?" selected":""),onClick:k=>{k.stopPropagation(),t(u.path,!0)},onDoubleClick:()=>_(u.path),onDrop:k=>V(k,u.path),onDragOver:k=>ee(k,u.path),onDragLeave:J,children:[e.jsx("span",{className:"icon",children:e.jsx(T,{name:pe("dir")||H("dir")})})," ",u.name,u.isSymlink&&e.jsx("span",{title:"Symbolic Link",style:{marginLeft:4,opacity:.5},children:"ðŸ”—"}),u.isBroken&&e.jsx("span",{title:"Broken Link",style:{marginLeft:4},children:"âŒ"}),u.isExternal&&e.jsx("span",{title:"External Link",style:{marginLeft:4},children:"â†—ï¸"}),ge===u.path?e.jsx("span",{style:{marginLeft:8,fontSize:12,color:"#888"},children:x("drop_to_upload")}):null]}):e.jsxs("div",{style:{display:"flex",gap:2,alignItems:"center"},children:[e.jsxs("button",{"data-path":u.path,type:"button",className:"entry",style:{flex:1,textAlign:"left"},onClick:()=>{if(o===!1){t(u.path,!1),a&&a("metadata");return}t(u.path,!1)},children:[e.jsx("span",{className:"icon",children:e.jsx(T,{name:bt(void 0,u.name)||pe(u.name.split(".").pop()||"")||H("view")||"icon-text"})})," ",u.name,u.isSymlink&&e.jsx("span",{title:"Symbolic Link",style:{marginLeft:4,opacity:.5},children:"ðŸ”—"}),u.isBroken&&e.jsx("span",{title:"Broken Link",style:{marginLeft:4},children:"âŒ"}),u.isExternal&&e.jsx("span",{title:"External Link",style:{marginLeft:4},children:"â†—ï¸"})]}),o?null:e.jsx("button",{className:"btn",onClick:()=>a?a(u.path):t(u.path,!1),title:x("view_file"),children:e.jsx(T,{name:H("view")})})]})},u.path))]})]}),g&&e.jsx(ln,{x:g.x,y:g.y,onClose:()=>M(null),items:[{label:x("open","Open"),icon:e.jsx(T,{name:H("view")}),action:()=>{g.item.isDir?(_(g.item.path),t(g.item.path,!0)):o?t(g.item.path,!1):a?a(g.item.path):t(g.item.path,!1)}},...g.item.isDir?[]:[{label:x("download"),icon:e.jsx(T,{name:H("download")}),action:()=>{const u=document.createElement("a");u.href=be(`/api/file?path=${encodeURIComponent(g.item.path)}${localStorage.getItem("mlcremote_token")?`&token=${encodeURIComponent(localStorage.getItem("mlcremote_token")||"")}`:""}`),u.download=g.item.name,document.body.appendChild(u),u.click(),document.body.removeChild(u)},separator:!0}],{label:x("copy_full_path"),icon:e.jsx(T,{name:H("copy")}),action:async()=>{try{await navigator.clipboard.writeText(g.item.path)}catch(u){console.error("Failed to copy",u)}}},{label:x("copy_relative_path"),icon:e.jsx(T,{name:H("link")}),action:async()=>{try{const u=g.item.path.startsWith("/")?g.item.path.slice(1):g.item.path;await navigator.clipboard.writeText(u)}catch(u){console.error("Failed to copy",u)}}},{label:x("copy_name"),icon:e.jsx(T,{name:H("text")}),action:async()=>{try{await navigator.clipboard.writeText(g.item.name)}catch(u){console.error(u)}},separator:!0},{label:x("delete"),icon:e.jsx(T,{name:H("trash")}),danger:!0,action:()=>ze(g.item.path)}]})]})}function dn({autoOpen:t,showHidden:n,onToggleAutoOpen:s,onToggleShowHidden:o,showLogs:a,onToggleLogs:m,hideMemoryUsage:c,onToggleHideMemoryUsage:l,onClose:h,onLanguageChange:f,maxEditorSize:j,onMaxFileSizeChange:$}){const{t:L,i18n:x}=Q(),[w,z]=G.useState(c),D=S=>{x.changeLanguage(S),f==null||f(S)},b=[{code:"en",name:"English"},{code:"de",name:"Deutsch"},{code:"es",name:"EspaÃ±ol"},{code:"fr",name:"FranÃ§ais"}];return e.jsx("div",{style:{position:"absolute",right:12,top:40,zIndex:60},children:e.jsxs("div",{style:{width:320,background:"var(--bg)",border:"1px solid var(--muted)",borderRadius:6,boxShadow:"0 6px 20px rgba(0,0,0,0.12)",padding:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("strong",{children:L("settings")}),e.jsx("button",{"aria-label":L("close"),title:L("close"),onClick:h,style:{background:"transparent",border:"none",cursor:"pointer"},children:e.jsx(T,{name:H("close"),size:16})})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,textTransform:"uppercase",color:"var(--text-muted)",display:"block",marginBottom:8,letterSpacing:"0.05em"},children:L("language")}),e.jsx("div",{style:{display:"flex",gap:8,marginTop:4},children:b.map(S=>{const O=x.language===S.code||S.code==="en"&&!x.language,K=S.code==="en"?"gb":S.code;return e.jsx("button",{onClick:()=>D(S.code),title:S.name,style:{display:"flex",alignItems:"center",justifyContent:"center",padding:6,background:O?"var(--bg-select)":"var(--bg-panel)",border:O?"1px solid var(--accent)":"1px solid var(--border)",borderRadius:6,cursor:"pointer",transition:"all 0.2s",opacity:O?1:.7},onMouseOver:A=>{O||(A.currentTarget.style.opacity="1")},onMouseOut:A=>{O||(A.currentTarget.style.opacity="0.7")},children:e.jsx(T,{name:`icon-flag-${K}`,size:24})},S.code)})})]}),e.jsx("div",{style:{marginTop:12},children:e.jsxs("label",{style:{fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:t,onChange:S=>s(S.target.checked)})," ",L("auto_open_files","Auto open files")]})}),e.jsx("div",{style:{marginTop:8},children:e.jsxs("label",{style:{fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:n,onChange:S=>o(S.target.checked)})," ",L("show_hidden_files","Show hidden files")]})}),e.jsx("div",{style:{marginTop:8},children:e.jsxs("label",{style:{fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:a,onChange:S=>m(S.target.checked)})," ",L("show_server_logs","Show server logs")]})}),e.jsx("div",{style:{marginTop:8},children:e.jsxs("label",{style:{fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:w,onChange:S=>{z(S.target.checked),l(S.target.checked)}})," ",L("hide_memory_usage","Hide memory usage gauge")]})}),e.jsxs("div",{style:{marginTop:12,borderTop:"1px solid var(--border)",paddingTop:8},children:[e.jsx("strong",{style:{fontSize:12,color:"var(--text-muted)"},children:L("editor_settings","Editor Settings")}),e.jsxs("div",{style:{marginTop:6,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("label",{style:{fontSize:13},title:L("max_file_size_tooltip","Files larger than this (MB) will open in read-only mode"),children:L("max_file_size","Max File Size (MB)")}),e.jsx("input",{type:"number",min:"0.1",step:"0.5",style:{width:60,background:"var(--bg-panel)",border:"1px solid var(--border)",color:"var(--text)",borderRadius:4,padding:"2px 4px"},value:((j||parseInt(localStorage.getItem("mlc_max_editor_size")||"1048576"))/1024/1024).toFixed(1),onChange:S=>{const O=parseFloat(S.target.value);if(O>0){const K=Math.floor(O*1024*1024);localStorage.setItem("mlc_max_editor_size",K.toString()),$==null||$(K)}}})]})]})]})})}function un(){const{t}=Q(),[n,s]=i.useState(null),[o,a]=i.useState(!1),m=i.useCallback(async()=>{a(!0);try{const h=await oe("/api/trash/recent");if(!h.ok)throw new Error("fetch failed");const f=await h.json();Array.isArray(f)&&f.length>0?s(f[0]):s(null)}catch(h){console.warn("Failed to fetch trash",h)}finally{a(!1)}},[]);if(i.useEffect(()=>{m();const h=setInterval(m,1e4);return()=>clearInterval(h)},[m]),o&&!n)return e.jsx("div",{className:"muted",children:t("loading_trash")});if(!n)return e.jsx("div",{className:"muted",children:t("trash_empty")});const c=n.originalPath.split("/").pop()||n.originalPath,l=bt(void 0,c)||pe(c.split(".").pop()||"")||"icon-trash";return e.jsxs("div",{style:{padding:12},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx(T,{name:l,size:20}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{fontWeight:600},children:c}),e.jsx("div",{className:"muted",style:{fontSize:12},children:new Date(n.deletedAt).toLocaleString()})]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsxs("div",{className:"muted",children:[t("original_path"),": ",n.originalPath]}),e.jsxs("div",{className:"muted",children:[t("trash_path"),": ",n.trashPath]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("button",{className:"btn",disabled:!0,children:t("undo_coming")}),(()=>{const h=Xe(),f=`/api/file?path=${encodeURIComponent(n.trashPath)}`+(h?`&token=${encodeURIComponent(h)}`:"");return e.jsx("a",{className:"btn",style:{marginLeft:8},href:f,download:c,children:t("download")})})()]})]})}function ce(t){if(!t||t<=0)return"0 B";const n=1024,s=n*1024,o=s*1024;return t>=o?`${(t/o).toFixed(2)} GB`:t>=s?`${(t/s).toFixed(2)} MB`:t>=n?`${(t/n).toFixed(2)} KB`:`${t} B`}const hn=new Set(["txt","md","markdown","yaml","yml","json","js","ts","jsx","tsx","html","css","env","ini","cfg","conf","csh","gitignore","dockerfile","sql"]),mn=new Set(["zip","gz","tar","rar","exe","dll","so","bin","jpg","jpeg","png","gif","webp","pdf"]);function Je(t){const n=t.split("/"),s=n[n.length-1]||"",o=s.lastIndexOf(".");return o===-1?"":s.slice(o+1).toLowerCase()}function jt(t){const n=Je(t);return!n||hn.has(n)?!0:!mn.has(n)}async function fn(t){if(!t)return{mime:"application/octet-stream",isText:!1,ext:""};try{const n=`?path=${encodeURIComponent(t)}`,s=await oe(`/api/filetype${n}`);if(!s.ok)throw new Error("probe failed");return await s.json()}catch{const s=Je(t);return{mime:"application/octet-stream",isText:jt(t),ext:s}}}function pn(t){if(!t)return null;const n=t.split("/"),o=(n[n.length-1]||"").toLowerCase();return o===".bashrc"||o==="bashrc"||o===".bash_profile"||o===".profile"?"bashrc":o===".zshrc"||o==="zshrc"?"zshrc":o===".bash_history"||o==="bash_history"?"bash_history":o==="makefile"?"makefile":o==="dockerfile"?"dockerfile":o==="nginx.conf"||o==="nginx.conf.default"?"conf":null}function gn(t){const n=Ke.languages;switch(t){case"jsx":return n.jsx;case"tsx":return n.tsx;case"java":return n.java;case"ini":case"gitconfig":case"editorconfig":case"conf":case"config":return n.ini;case"js":return n.javascript;case"ts":return n.typescript;case"go":return n.go;case"php":return n.php;case"json":return n.json;case"yaml":case"yml":return n.yaml;case"toml":return n.toml||n.markup;case"md":case"markdown":return n.markdown;case"c":case"h":return n.c;case"cpp":case"hpp":return n.cpp;case"py":return n.python;case"makefile":return n.makefile;case"bashrc":case"zshrc":case"bash_history":case"profile":return n.bash;case"sh":case"bash":return n.bash;case"xml":case"xml-doc":return n["xml-doc"];case"html":case"htm":return n.markup;case"css":case"sass":case"scss":return n.sass;case"sql":return n.sql;default:return n.javascript}}function Ee(t){switch(t){case"js":case"jsx":return"javascript";case"ts":case"tsx":return"typescript";case"go":return"go";case"php":return"php";case"json":return"json";case"yaml":case"yml":return"yaml";case"toml":return"toml";case"ini":case"gitconfig":case"editorconfig":case"conf":case"config":return"ini";case"md":case"markdown":return"markdown";case"c":case"h":return"c";case"cpp":case"cxx":case"c++":case"hpp":return"cpp";case"py":return"python";case"makefile":return"makefile";case"dockerfile":return"dockerfile";case"sh":case"bash":case"csh":return"bash";case"bashrc":case"zshrc":case"bash_history":case"profile":return"bash";case"xml":case"xml-doc":return"xml-doc";case"html":case"htm":return"markup";case"sass":case"scss":return"sass";case"sql":return"sql";case"less":case"css":return"css";default:return"text"}}function pt(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function xn(t,n){try{const s=gn(n),o=Ee(n);return s?Ke.highlight(t,s,o):pt(t)}catch(s){return console.warn("Prism highlight failed",s),pt(t)}}function yn({content:t,setContent:n,origContent:s,ext:o,alias:a,textareaId:m}){const{t:c}=Q(),l=i.useRef(null),h=i.useRef(null);return i.useEffect(()=>{var j;const f=a||Ee(o);h.current&&h.current.setAttribute("data-grammar",f),l.current&&l.current.setAttribute("data-grammar",f);try{const $=(j=h.current)==null?void 0:j.querySelector("code");$&&Ke.highlightElement($)}catch{}},[a,t,o]),i.useEffect(()=>{l.current&&h.current&&(h.current.scrollTop=l.current.scrollTop,h.current.scrollLeft=l.current.scrollLeft)},[t]),e.jsxs("div",{className:"editor-edit-area",children:[e.jsx("pre",{"aria-hidden":!0,className:`highlight-wrap language-${a||Ee(o)}`,"data-grammar":a||Ee(o),ref:f=>{h.current=f},children:e.jsx("code",{className:`language-${a||Ee(o)}`,dangerouslySetInnerHTML:{__html:xn(t||"",o)}})}),e.jsx("textarea",{ref:l,className:"textarea",wrap:"off",value:t,name:m||"editor",id:m,"data-grammar":a,onChange:f=>n(f.target.value),onScroll:()=>{l.current&&h.current&&(h.current.scrollTop=l.current.scrollTop,h.current.scrollLeft=l.current.scrollLeft)},placeholder:c("open_or_create_file"),spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",autoComplete:"off"})]})}function _n({path:t,onDimensions:n}){const{t:s}=Q(),o=Xe(),a=be(`/api/file?path=${encodeURIComponent(t)}${o?`&token=${encodeURIComponent(o)}`:""}`),[m,c]=i.useState(null),l=i.useRef(null);return e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",overflow:"hidden"},children:e.jsx("img",{ref:l,src:a,alt:t.split("/").pop(),style:{maxWidth:"100%",maxHeight:"80vh",objectFit:"contain",borderRadius:6,boxShadow:"0 2px 8px rgba(0,0,0,0.4)"},onLoad:()=>{try{const h=l.current;if(h&&h.naturalWidth&&h.naturalHeight){c({w:h.naturalWidth,h:h.naturalHeight});try{n&&n(h.naturalWidth,h.naturalHeight)}catch{}}}catch{}}})}),e.jsxs("div",{style:{marginTop:8,display:"flex",gap:8,alignItems:"center"},children:[e.jsx("a",{className:"link",href:a,download:t.split("/").pop(),children:s("download")}),m?e.jsxs("span",{className:"muted",style:{marginLeft:8},children:[m.w," Ã— ",m.h]}):null]})]})}const vn=i.lazy(()=>Ie(()=>import("./PdfPreview-BcfZ5AQn.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url));function wn({path:t}){const{t:n}=Q();return e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"muted",children:n("loading_pdf")}),children:e.jsx(vn,{path:t})})}const bn=i.lazy(()=>Ie(()=>import("./ShellView-C5F6kzw9.js"),__vite__mapDeps([10,1,2,3,4,11,6,7,5,8,9]),import.meta.url)),jn={name:"Shell",priority:100,matches:t=>!!(t.path&&t.path.startsWith("shell-")),view:({path:t})=>e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"muted",children:"Loading shellâ€¦"}),children:e.jsx(bn,{path:t})}),isEditable:!1},Sn={name:"Directory",priority:90,matches:t=>!!(t.meta&&t.meta.isDir),view:({path:t,origContent:n})=>e.jsxs("div",{style:{padding:12},children:[e.jsxs("div",{style:{fontWeight:600},children:["Directory: ",t]}),e.jsxs("div",{className:"muted",style:{marginTop:6},children:[n?n.split(`
`).length:"0"," entries"]}),e.jsx("pre",{style:{marginTop:8,maxHeight:240,overflow:"auto",padding:8,background:"var(--panel)"},children:n})]}),isEditable:!1},$n={name:"PDF",priority:80,matches:t=>t.probe&&t.probe.mime==="application/pdf"||!!t.path&&t.path.toLowerCase().endsWith(".pdf"),view:({path:t})=>e.jsx(wn,{path:t}),isEditable:!1},kn={name:"Image",priority:70,matches:t=>{if(t.probe&&t.probe.mime&&t.probe.mime.startsWith("image/"))return!0;if(t.path){const n=t.path.toLowerCase();return n.endsWith(".png")||n.endsWith(".jpg")||n.endsWith(".jpeg")||n.endsWith(".gif")||n.endsWith(".svg")||n.endsWith(".webp")}return!1},view:({path:t,onDimensions:n})=>e.jsx(_n,{path:t,onDimensions:n}),isEditable:!1},En={name:"Text",priority:50,matches:t=>t.probe&&t.probe.isText?!0:t.probe&&!t.probe.isText?!1:!!(t.path&&jt(t.path)),view:({content:t,setContent:n,origContent:s,ext:o,alias:a,textareaId:m})=>e.jsx(yn,{content:t||"",setContent:n||(()=>{}),origContent:s||"",ext:o||"",alias:a,textareaId:m||"editor"}),isEditable:!0},Cn={name:"Binary",priority:10,matches:t=>!!(t.probe&&!t.probe.isText),view:({path:t})=>e.jsxs("div",{style:{marginTop:8,display:"flex",gap:8},children:[e.jsx("a",{className:"link",href:be(`/api/file?path=${encodeURIComponent(t)}`),download:t.split("/").pop(),children:"Download"}),e.jsx("span",{className:"muted",children:"(Binary or unsupported file type)"})]}),isEditable:!1},St={name:"Unsupported",priority:0,matches:()=>!0,view:({path:t})=>e.jsxs("div",{style:{padding:12},className:"muted",children:["Unsupported file type: ",t]}),isEditable:!1},Ln=[jn,Sn,$n,kn,En,Cn,St].sort((t,n)=>n.priority-t.priority);function Ge(t){for(const n of Ln)if(n.matches(t))return n;return St}function Nn(t){return t.charCodeAt(0)===65279?{text:t.slice(1),hasBOM:!0}:{text:t,hasBOM:!1}}function Tn(t){return"\uFEFF"+t}function Rn({path:t,onSaved:n,settings:s,reloadTrigger:o,onUnsavedChange:a,onMeta:m}){const{t:c}=Q(),[l,h]=i.useState(""),[f,j]=i.useState(""),[$,L]=i.useState(!1),[x,w]=i.useState(""),[z,D]=i.useState(!1),[b,S]=i.useState(null),[O,K]=i.useState(!1),[A,ge]=i.useState(null),[re,ae]=i.useState(null),[de,g]=i.useState(null),[M,_]=i.useState(null),[U,P]=i.useState(!1),N=i.useRef(null),V=i.useRef(null),ee=i.useRef(null),J=Ge({path:t,meta:b,probe:A}),he=J.view,Z=i.useCallback(async(C=!1)=>{if(t){D(!0),w("");try{const R=await fe(t);if(S(R),typeof m=="function"&&m(R),!C&&de&&M&&R.modTime!==M&&!confirm(c("confirm_reload_external","File has been modified externally. Reload?"))){D(!1);return}_(R.modTime);const se=await fn(t);ge(se);const ue=Ge({path:t,meta:R,probe:se});if(R.isDir){h(""),D(!1);return}if(ue.name==="Text"){const _e=await en(t),{text:Se,hasBOM:$e}=Nn(_e);h(Se),j(Se),L($e),g(Date.now()),P(!1)}else h(""),D(!1)}catch{A&&A.isText&&(w(c("failed_to_load","Failed to load")),P(!0)),g(null)}finally{D(!1)}}},[t,c]),je=(()=>{try{const C=localStorage.getItem("mlc_max_editor_size");if(C)return parseInt(C,10)}catch{}return 1024*1024})(),u=async(C,R=64*1024)=>{if(t){K(!0);try{const se=`?path=${encodeURIComponent(t)}&offset=${C}&length=${R}`,ue=await oe(`/api/file/section${se}`);if(!ue.ok)throw new Error("section fetch failed");const _e=await ue.text();h(_e),j(_e)}catch{w(c("failed_to_load_section","Failed to load section"))}finally{K(!1)}}},W=pn(t)||A&&A.ext||Je(t),q=void 0,te=A&&A.ext?A.ext:"text",ie=(C=>C?"editor-"+C.replace(/[^a-z0-9_-]/gi,"-").replace(/-+/g,"-"):"editor")(t||"");i.useEffect(()=>{Z()},[Z]),i.useEffect(()=>{let C=!0;return(async()=>{if(!(!b||!b.isDir||!t))try{const R=await vt(t);if(!C)return;h(""),j(R.map(se=>se.name).join(`
`))}catch{}})(),()=>{C=!1}},[b,t]),i.useEffect(()=>{o&&o>0&&Z(!0)},[o,Z]),i.useEffect(()=>{N.current&&V.current&&(V.current.scrollTop=N.current.scrollTop,V.current.scrollLeft=N.current.scrollLeft)},[l]),i.useEffect(()=>{if(N.current&&V.current){const C=window.getComputedStyle(V.current),R=C.lineHeight,se=C.paddingTop,ue=C.paddingBottom;R&&(N.current.style.lineHeight=R),se&&(N.current.style.paddingTop=se),ue&&(N.current.style.paddingBottom=ue)}},[l,t]),i.useEffect(()=>{var C;V.current&&V.current.setAttribute("data-grammar",te),N.current&&(N.current.setAttribute("data-grammar",te),ie&&(N.current.id=ie));try{const R=(C=V.current)==null?void 0:C.querySelector("code");R&&Prism.highlightElement(R)}catch{}},[te,l,ie]),i.useEffect(()=>{if(!a||!J.isEditable)return;const C=l!==f;if(ee.current===null||ee.current!==C){try{a(t,C)}catch(R){console.warn("onUnsavedChange threw",R)}ee.current=C}},[l,f,a,t,J.isEditable]);const ye=async()=>{if(t){w(c("saving","Saving..."));try{const C=$?Tn(l):l;await tn(t,C),w(c("saved","Saved")),setTimeout(()=>w(R=>R===c("saved","Saved")?"":R),1500),await Z(!0),n&&n()}catch{w(c("save_failed","Save failed"))}}},De=async()=>{if(t&&!(l!==f&&!confirm(c("confirm_reload_unsaved","You have unsaved changes. Reloading will discard them. Continue?")))){w(c("reloading","Reloading..."));try{await Z(!0),w(c("reloaded","Reloaded")),setTimeout(()=>w(C=>C===c("reloaded","Reloaded")?"":C),1500)}catch{w(c("reload_failed","Reload failed"))}}};return i.useEffect(()=>{const C=R=>{(R.ctrlKey||R.metaKey)&&R.key==="s"&&(R.preventDefault(),ye())};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[ye]),e.jsxs("div",{className:"editor",children:[e.jsxs("div",{className:"editor-header",children:[e.jsx("strong",{children:c("editor")}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{className:"muted",children:b&&b.absPath?b.absPath:t||c("select_or_create")}),b&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"muted",style:{fontSize:11},children:[b.isDir?"directory":J.name,"Â· ",b.mode," Â· ",new Date(b.modTime).toLocaleString()," ",b.size?`Â· ${ce(b.size)}`:""]}),re&&J.name==="Image"?e.jsxs("span",{style:{fontSize:11,marginLeft:8},className:"muted",children:[re.w," Ã— ",re.h]}):null]})]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"link icon-btn",title:c("refresh"),"aria-label":c("refresh"),onClick:De,disabled:!t,children:e.jsx(T,{name:pe("refresh")||"icon-refresh",title:c("refresh"),size:16})}),J.isEditable&&l!==f&&e.jsx("button",{className:"link icon-btn",title:c("save"),"aria-label":c("save"),onClick:ye,disabled:!t,children:e.jsx(T,{name:pe("upload")||"icon-upload",title:c("save"),size:16})})]}),b&&b.size&&b.size>je&&J.isEditable?e.jsxs("div",{style:{marginLeft:12},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:c("file_too_large","File is large ({{size}}). Full edit disabled.",{size:ce(b.size)})}),e.jsxs("div",{style:{marginTop:6,display:"flex",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>u(0,64*1024),children:c("view_head","View head")}),e.jsx("button",{className:"btn",onClick:()=>u(Math.max(0,(b.size||0)-64*1024),64*1024),children:c("view_tail","View tail")})]}),O&&e.jsx("div",{className:"muted",children:c("loading_section","Loading section...")})]}):null,x&&e.jsx("div",{className:"muted",children:x})]}),e.jsx("div",{className:"editor-body",children:z?e.jsx("div",{className:"muted",children:c("loading")}):e.jsx(he,{path:t,content:l,setContent:h,origContent:f,ext:W,alias:q,textareaId:ie,onDimensions:(C,R)=>ae({w:C,h:R})})})]})}function In({path:t}){const{t:n}=Q(),[s,o]=i.useState(null),[a,m]=i.useState(null);return i.useEffect(()=>{let c=!0;return(async()=>{if(!t){o(null);return}try{const l=await fe(t);if(!c)return;o(l),m(null)}catch(l){if(!c)return;m((l==null?void 0:l.message)||n("failed_fetch_metadata")),o(null)}})(),()=>{c=!1}},[t,n]),t?e.jsxs("div",{style:{padding:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:t.split("/").pop()}),e.jsx("div",{className:"muted",style:{fontSize:12},children:t})]}),e.jsx("div",{children:e.jsx("a",{className:"link",href:`/api/file?path=${encodeURIComponent(t)}`,download:t.split("/").pop(),children:n("download")})})]}),e.jsxs("div",{style:{marginTop:12},children:[a?e.jsx("div",{className:"error",children:a}):null,s?e.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{width:160,padding:6},className:"muted",children:n("full_path")}),e.jsx("td",{style:{padding:6},children:s.path||t})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"muted",style:{padding:6},children:n("mime")}),e.jsx("td",{style:{padding:6},children:s.mime||"unknown"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"muted",style:{padding:6},children:n("size")}),e.jsx("td",{style:{padding:6},children:s.size?ce(s.size):"n/a"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"muted",style:{padding:6},children:n("mode")}),e.jsx("td",{style:{padding:6},children:s.mode||"n/a"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"muted",style:{padding:6},children:n("last_modified")}),e.jsx("td",{style:{padding:6},children:s.modTime?new Date(s.modTime).toLocaleString():"n/a"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"muted",style:{padding:6},children:n("is_dir")}),e.jsx("td",{style:{padding:6},children:s.isDir?n("yes"):n("no")})]})]})}):e.jsx("div",{className:"muted",children:n("loading_metadata")})]})]}):e.jsx("div",{style:{padding:12},className:"muted",children:n("no_file_selected")})}function zn({path:t}){const{t:n}=Q(),[s,o]=i.useState(null),[a,m]=i.useState(null);return i.useEffect(()=>{let c=!0;return(async()=>{if(!t){o(null);return}try{const l=await fe(t);if(!c)return;o(l),m(null)}catch(l){if(!c)return;m((l==null?void 0:l.message)||n("failed_fetch_metadata")),o(null)}})(),()=>{c=!1}},[t,n]),t?e.jsxs("div",{style:{padding:24,maxWidth:600,margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16,marginBottom:32},children:[e.jsx("div",{style:{fontSize:48,opacity:.8},children:e.jsx(T,{name:pe(t.split(".").pop()||"")||"icon-file",size:48})}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx("h2",{style:{margin:0,wordBreak:"break-all"},children:t.split("/").pop()})}),e.jsx("div",{style:{display:"flex",gap:12},children:s&&!s.isDir&&e.jsxs("a",{className:"btn primary",href:be(`/api/file?path=${encodeURIComponent(t)}`),download:t.split("/").pop(),children:[e.jsx("span",{style:{marginRight:6,display:"inline-flex"},children:e.jsx(T,{name:"icon-download",size:16})}),n("download")]})})]}),e.jsxs("div",{className:"panel",style:{padding:16,borderRadius:8,background:"var(--bg-subtle)"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:16,borderBottom:"1px solid var(--border)",paddingBottom:8},children:n("properties","Properties")}),a?e.jsx("div",{className:"error",children:a}):null,s?e.jsx("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{width:120,padding:"8px 0",color:"var(--text-muted)"},children:n("path","Path")}),e.jsx("td",{style:{padding:"8px 0",wordBreak:"break-all"},children:t})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{width:120,padding:"8px 0",color:"var(--text-muted)"},children:n("type")}),e.jsx("td",{style:{padding:"8px 0"},children:s.mime||"unknown"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 0",color:"var(--text-muted)"},children:n("size")}),e.jsx("td",{style:{padding:"8px 0"},children:s.size?ce(s.size):"0 B"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 0",color:"var(--text-muted)"},children:n("mode")}),e.jsx("td",{style:{padding:"8px 0"},children:e.jsx("span",{style:{fontFamily:"monospace",background:"var(--bg)",padding:"2px 4px",borderRadius:4},children:s.mode||"n/a"})})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 0",color:"var(--text-muted)"},children:n("last_modified")}),e.jsx("td",{style:{padding:"8px 0"},children:s.modTime?new Date(s.modTime).toLocaleString():"n/a"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 0",color:"var(--text-muted)"},children:n("is_dir")}),e.jsx("td",{style:{padding:"8px 0"},children:s.isDir?n("yes"):n("no")})]})]})}):e.jsxs("div",{className:"muted",children:[n("loading"),"..."]})]})]}):e.jsx("div",{style:{padding:24,textAlign:"center"},className:"muted",children:n("no_file_selected")})}function Dn({openFiles:t,active:n,onActivate:s,onClose:o,onCloseOthers:a,onCloseLeft:m,titles:c,fullPaths:l,types:h,evictedTabs:f=[],onRestoreEvicted:j}){const{t:$}=Q(),[L,x]=i.useState(null),w=i.useRef(null),z=i.useRef(null),[D,b]=i.useState(!1),[S,O]=i.useState(!1),[K,A]=i.useState(!1),[ge,re]=i.useState(null),ae=()=>{const g=z.current;if(!g){b(!1),O(!1);return}b(g.scrollLeft>0),O(g.scrollWidth>g.clientWidth+g.scrollLeft+1)},de=g=>{const M=z.current;M&&(M.scrollBy({left:g,behavior:"smooth"}),setTimeout(ae,220))};return i.useEffect(()=>{function g(_){w.current&&(_.target instanceof Node&&w.current.contains(_.target)||x(null))}function M(_){_.key==="Escape"&&x(null)}return document.addEventListener("click",g),document.addEventListener("keydown",M),()=>{document.removeEventListener("click",g),document.removeEventListener("keydown",M)}},[]),i.useEffect(()=>{ae();function g(){ae()}window.addEventListener("resize",g);function M(){const _=z.current,U=140;if(!_){re(null);return}const P=_.clientWidth,N=Math.max(1,Math.floor(P/U));re(N)}return window.addEventListener("resize",M),M(),()=>{window.removeEventListener("resize",g),window.removeEventListener("resize",M)}},[t]),e.jsxs("div",{className:"tabbar",ref:w,children:[(()=>{const M=z.current?z.current.clientWidth:600,_=ge??Math.max(1,Math.floor(M/140)),U=t.length>_?t.slice(0,t.length-_):[];return U.length===0?null:e.jsxs("div",{className:"tab-evicted-dropdown",style:{display:"flex",alignItems:"center",marginRight:8,position:"relative"},children:[e.jsx("button",{className:"btn",onClick:()=>A(P=>!P),children:"â‹¯"}),K&&e.jsx("div",{style:{position:"absolute",left:0,top:"100%",background:"var(--bg)",boxShadow:"0 4px 12px rgba(0,0,0,0.2)",padding:8,zIndex:50},children:U.map(P=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 8px"},children:[e.jsx("button",{className:"link",onClick:()=>{j&&j(P),A(!1)},style:{flex:1,textAlign:"left"},children:c&&c[P]||P.split("/").pop()}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-small",title:$("restore"),onClick:()=>{j&&j(P),A(!1)},children:"â†º"}),e.jsx("button",{className:"btn btn-small",title:$("close"),onClick:()=>{o&&o(P),A(!1)},children:"âœ•"}),e.jsx("button",{className:"btn btn-small",title:$("close_others"),onClick:()=>{U.filter(N=>N!==P).forEach(N=>o&&o(N)),A(!1)},children:"â‹¯"})]})]},P))})]})})(),D&&e.jsx("button",{className:"tab-scroll tab-scroll-left","aria-label":$("scroll_left"),onClick:()=>de(-200),children:"â—€"}),e.jsx("div",{className:"tab-scroll-area",ref:z,onScroll:ae,children:t.map((g,M)=>e.jsx("div",{className:"tab-item",style:{display:"flex",alignItems:"center",gap:8,padding:"4px 8px"},children:e.jsxs("button",{className:g===n?"btn":"link",onClick:()=>s(g),onContextMenu:_=>{_.preventDefault(),x(M)},style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"tab-icon",children:(()=>{if(g==="metadata")return e.jsx(T,{name:H("view")});if((h&&h[g])==="shell")return e.jsx(T,{name:H("terminal")});if((h&&h[g])==="dir")return e.jsx(T,{name:H("folder")});const _=(g.split(".").pop()||"").toLowerCase(),U=pe(_);return e.jsx(T,{name:U})})()},`${(h==null?void 0:h[g])||"file"}-${g}`),(()=>{const _=c&&c[g]||g.split("/").pop()||g,U=_.length>10?_.slice(0,10)+"â€¦":_,P=c&&c[g]&&c[g].startsWith("*")?"tab-title tab-unsaved":"tab-title";return e.jsx("span",{title:(l==null?void 0:l[g])||_,className:P,style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:120},children:U})})()]})},g))}),L!==null&&(()=>{const g=t[L];if(!g)return null;const M=w.current,_=z.current;let U={position:"absolute",right:8,top:40,padding:8,display:"flex",flexDirection:"column",gap:6};try{const P=_==null?void 0:_.querySelectorAll(".tab-item"),N=P?P[L]:null;if(N&&M){const V=M.getBoundingClientRect(),ee=N.getBoundingClientRect();U={position:"absolute",left:ee.left-V.left,top:ee.bottom-V.top+6,padding:8,display:"flex",flexDirection:"column",gap:6}}}catch{}return e.jsxs("div",{className:"dropdown",style:U,children:[e.jsx("button",{ref:P=>{P&&P.focus()},className:"link",onClick:()=>{o==null||o(g),x(null)},children:$("close")}),t.length>1&&e.jsx("button",{className:"link",onClick:()=>{a==null||a(g),x(null)},children:$("close_others")}),L>0&&e.jsx("button",{className:"link",onClick:()=>{m==null||m(g),x(null)},children:$("close_left")})]})})(),S&&e.jsx("button",{className:"tab-scroll tab-scroll-right","aria-label":$("scroll_right"),onClick:()=>de(200),children:"â–¶"})]})}const Mn=`MIT License\r
\r
Copyright (c) 2025 michael lechner\r
\r
Permission is hereby granted, free of charge, to any person obtaining a copy\r
of this software and associated documentation files (the "Software"), to deal\r
in the Software without restriction, including without limitation the rights\r
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r
copies of the Software, and to permit persons to whom the Software is\r
furnished to do so, subject to the following conditions:\r
\r
The above copyright notice and this permission notice shall be included in all\r
copies or substantial portions of the Software.\r
\r
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r
SOFTWARE.\r
`;function Pn({onComplete:t}){const{t:n,i18n:s}=Q(),[o,a]=G.useState("language"),[m,c]=G.useState(!1),l=[{code:"en",name:"English",flag:"ðŸ‡ºðŸ‡¸"},{code:"de",name:"Deutsch",flag:"ðŸ‡©ðŸ‡ª"}],h=f=>{s.changeLanguage(f),a("license")};return e.jsxs("div",{className:"setup-wizard",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",background:"var(--bg)",color:"var(--text)",padding:"2rem"},children:[e.jsxs("div",{style:{width:"100%",maxWidth:"600px",background:"var(--bg-secondary)",borderRadius:"8px",padding:"2rem",boxShadow:"0 4px 20px rgba(0,0,0,0.3)",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h1",{style:{margin:"0 0 0.5rem",fontSize:"1.8rem"},children:o==="language"?"Welcome to MLCRemote":n("license_agreement","License Agreement")}),e.jsx("p",{style:{margin:0,opacity:.7},children:o==="language"?"Please select your language":n("please_accept_license","Please review and accept the license terms to continue.")})]}),o==="language"?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginTop:"1rem"},children:l.map(f=>e.jsxs("button",{className:"btn",onClick:()=>h(f.code),style:{padding:"1.5rem",fontSize:"1.2rem",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.5rem",border:s.language===f.code?"2px solid var(--accent)":"1px solid var(--border-color)",background:"var(--bg)"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:f.flag}),f.name]},f.code))}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("div",{style:{height:"300px",overflowY:"auto",background:"var(--bg)",border:"1px solid var(--border-color)",padding:"1rem",borderRadius:"4px",fontFamily:"monospace",fontSize:"0.9rem",whiteSpace:"pre-wrap"},children:Mn}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",userSelect:"none"},children:[e.jsx("input",{type:"checkbox",checked:m,onChange:f=>c(f.target.checked),style:{width:"1.2rem",height:"1.2rem"}}),n("i_accept_terms","I accept the terms in the License Agreement")]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"1rem"},children:[e.jsx("button",{className:"btn link",onClick:()=>a("language"),children:n("back","Back")}),e.jsx("button",{className:"btn btn-primary",disabled:!m,onClick:t,style:{padding:"0.6rem 2rem"},children:n("continue","Continue")})]})]})]}),e.jsx("div",{style:{marginTop:"2rem",opacity:.5,fontSize:"0.8rem"},children:"MLCRemote v1.0.1"})]})}function On({visible:t=!0,onClose:n}){const{t:s}=Q(),[,o]=i.useState(0);if(i.useEffect(()=>Kt(()=>o(l=>l+1)),[]),!t)return null;const a=Gt().slice(0,100);function m(c){const l=[],h=/([\w\/\.\-]+:\d+)/g;let f=0,j;for(;(j=h.exec(c))!==null;)j.index>f&&l.push({text:c.slice(f,j.index)}),l.push({text:j[0],cls:"log-path"}),f=j.index+j[0].length;return f<c.length&&l.push({text:c.slice(f)}),l.map(($,L)=>$.cls?e.jsx("span",{className:$.cls,children:$.text},L):e.jsx("span",{children:$.text},L))}return e.jsxs("div",{className:"log-overlay",children:[e.jsxs("div",{className:"log-header",children:[e.jsx("strong",{children:s("logs")}),e.jsxs("div",{children:[e.jsx("button",{className:"btn",onClick:()=>Xt(),children:s("clear")}),e.jsx("button",{className:"btn",onClick:()=>n&&n(),style:{marginLeft:8},children:s("close")})]})]}),e.jsx("div",{children:a.map((c,l)=>e.jsxs("div",{className:`log-entry log-level-${(c.level||"").toLowerCase()}`,children:[e.jsxs("div",{className:"log-meta",children:[c.ts," ",e.jsx("span",{className:"log-level",children:c.level})]}),e.jsx("div",{className:"log-message",children:m(c.msg)})]},l))})]})}async function gt(t,n="mlcremote-screenshot.png"){const s=await Ut(t,{backgroundColor:null,scale:2});return new Promise(o=>{s.toBlob(a=>{if(!a){o();return}const m=URL.createObjectURL(a),c=document.createElement("a");c.href=m,c.download=n,document.body.appendChild(c),c.click(),c.remove(),URL.revokeObjectURL(m),o()},"image/png")})}class Fn{constructor(n=""){ht(this,"prefix");this.prefix=n}key(n){return`${this.prefix}${n}`}get(n,s,o=null){try{const a=localStorage.getItem(this.key(n)),m=s.read(a);return m===null?o:m}catch{return o}}getOrDefault(n,s,o){const a=this.get(n,s,null);return a===null?o:a}set(n,s,o){try{localStorage.setItem(this.key(n),o.write(s))}catch{}}remove(n){try{localStorage.removeItem(this.key(n))}catch{}}}const Ve={read:t=>t===null?null:t,write:t=>String(t)},xt={read:t=>t===null?null:t==="1"||t==="true",write:t=>t?"1":"0"},ke=new Fn("mlc:");function An({title:t,message:n,onClose:s}){const{t:o}=Q();return i.useEffect(()=>{const a=m=>{m.key==="Escape"&&s()};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[s]),e.jsx("div",{className:"login-overlay",onClick:s,children:e.jsxs("div",{className:"login-box",onClick:a=>a.stopPropagation(),style:{minWidth:350,maxWidth:500},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h3",{style:{margin:0,fontSize:18},children:t}),e.jsx("button",{className:"link icon-btn",onClick:s,"aria-label":o("close"),children:e.jsx(T,{name:H("close"),size:16})})]}),e.jsx("div",{style:{marginBottom:24,fontSize:14,lineHeight:"1.5",color:"var(--text-muted)"},children:n}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{className:"btn",onClick:s,children:o("close")})})]})})}function Bn({health:t,isOnline:n,hideMemoryUsage:s,lastHealthAt:o}){const{t:a}=Q(),[m,c]=i.useState(new Date);return i.useEffect(()=>{const l=window.setInterval(()=>c(new Date),1e3);return()=>window.clearInterval(l)},[]),e.jsxs("div",{className:"status-bar",style:{height:24,background:"var(--bg-alt)",borderTop:"1px solid var(--border)",display:"flex",alignItems:"center",padding:"0 8px",fontSize:12,color:"var(--text-muted)",justifyContent:"space-between",userSelect:"none"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},title:o?`${a("last_checked","Last checked")}: ${new Date(o).toLocaleTimeString()}`:"",children:[e.jsx("span",{style:{width:8,height:8,borderRadius:4,background:t&&t.host?"#10b981":n?"#f59e0b":"#ef4444"}}),e.jsx("span",{children:t&&t.host?t.host:n?a("connecting"):a("offline","Offline")})]}),e.jsxs("span",{className:n?"ok":"err",title:a(n?"status_connected":"disconnected"),children:[e.jsx(T,{name:"icon-circle-filled",size:10})," ",n?a("online","Online"):a("offline","Offline")]}),t&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sep"}),e.jsxs("span",{title:`PID: ${t.pid}`,children:["Host: ",t.host||"localhost"]}),t.os&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sep"}),e.jsx("span",{title:`OS: ${t.os} ${t.distro||""}`,children:t.distro||t.os})]}),e.jsx("span",{className:"sep"}),e.jsx("span",{title:a("server_time","Server Time"),children:t.server_time?new Date(t.server_time).toLocaleTimeString():""})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[!s&&t&&t.sys_mem_total_bytes?(()=>{const l=t.sys_mem_total_bytes||1,h=t.sys_mem_free_bytes||0,f=l-h,j=Math.round(f/l*100);return e.jsx("div",{style:{display:"flex",alignItems:"center",gap:6},title:`System Memory: ${ce(f)} / ${ce(l)} (${j}%)`,children:e.jsxs("div",{style:{width:32,height:14,background:"var(--bg-panel)",border:"1px solid var(--border)",borderRadius:3,position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{width:`${j}%`,height:"100%",background:j>85?"#ef4444":j>60?"#f59e0b":"#3b82f6",transition:"width 0.5s ease"}}),e.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",fontSize:9,fontWeight:700,color:"var(--text)",textShadow:"0 0 2px var(--bg)"},children:[j,"%"]})]})})})():null,e.jsx("div",{title:m.toLocaleDateString(),children:new Intl.DateTimeFormat(void 0,{hour:"numeric",minute:"numeric",second:"numeric"}).format(m)})]})]})}function Hn({direction:t="vertical",initialSize:n=50,minSize:s=10,onResize:o,children:a,className:m}){const[c,l]=G.useState(n);G.useEffect(()=>{l(n)},[n]);const h=G.useRef(null),f=G.useRef(!1),j=G.useRef(n),$=t==="vertical",L=z=>{z.preventDefault(),f.current=!0,j.current=c,document.addEventListener("mousemove",x),document.addEventListener("mouseup",w),document.body.style.cursor=$?"col-resize":"row-resize",document.body.style.userSelect="none";const D=document.createElement("div");D.id="split-drag-overlay",D.style.position="fixed",D.style.top="0",D.style.left="0",D.style.width="100%",D.style.height="100%",D.style.zIndex="9999",D.style.cursor=$?"col-resize":"row-resize",document.body.appendChild(D)},x=z=>{if(!f.current||!h.current)return;const D=h.current.getBoundingClientRect();let b=0;$?b=(z.clientX-D.left)/D.width*100:b=(z.clientY-D.top)/D.height*100,b=Math.max(s,Math.min(100-s,b)),l(b),j.current=b},w=()=>{f.current=!1,document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",w),document.body.style.cursor="",document.body.style.userSelect="";const z=document.getElementById("split-drag-overlay");z&&z.remove(),o&&o(j.current)};return e.jsxs("div",{ref:h,className:`split-pane-container ${t} ${m||""}`,style:{display:"flex",flexDirection:$?"row":"column",width:"100%",height:"100%",overflow:"hidden"},children:[e.jsx("div",{style:{flexBasis:`${c}%`,flexGrow:0,flexShrink:0,overflow:"hidden",position:"relative"},children:a[0]}),e.jsx("div",{className:"split-resizer",style:{flexBasis:"4px",cursor:$?"col-resize":"row-resize",background:"var(--border-color, #444)",zIndex:100,transition:"background 0.2s",position:"relative",alignSelf:"stretch"},onMouseDown:L,children:e.jsx("div",{style:{position:"absolute",top:$?0:-4,bottom:$?0:-4,left:$?-4:0,right:$?-4:0,zIndex:10}})}),e.jsx("div",{style:{flex:1,overflow:"hidden",position:"relative"},children:a[1]})]})}const Un=i.lazy(()=>Ie(()=>import("./TerminalTab-B7QhccUl.js"),__vite__mapDeps([11,1,2,3,4,6,7,5,8,9]),import.meta.url));function Wn(){var ct,dt;const{t,i18n:n}=Q(),{health:s,isOnline:o,lastHealthAt:a,refreshHealth:m,login:c,setToken:l,logout:h,showLogin:f,setShowLogin:j,showTokenInput:$,setShowTokenInput:L,showAuthChooser:x,setShowAuthChooser:w}=rn(),[z,D]=i.useState(0),b=i.useRef(null);i.useEffect(()=>{!b.current&&s&&D(Date.now()),b.current=s},[s]);const[S,O]=i.useState(""),[K,A]=i.useState(""),ge=i.useCallback(r=>A(r),[]),[re,ae]=i.useState(0),[de,g]=i.useState(!0),[M,_]=i.useState({root:{id:"root",files:[],activeFile:null}}),[U,P]=i.useState({type:"leaf",paneId:"root"}),[N,V]=i.useState("root"),ee=((ct=M[N])==null?void 0:ct.files)||[],J=((dt=M[N])==null?void 0:dt.activeFile)||"",he=r=>{_(p=>{const d=p[N];if(!d)return p;const E=r(d.files);return{...p,[N]:{...d,files:E}}})},Z=r=>{_(p=>{const d=p[N];return d?{...p,[N]:{...d,activeFile:r}}:p})},[ze,je]=i.useState([]),[u,k]=i.useState(null),[W,q]=i.useState(!0),te=r=>{q(r),me({autoOpen:r}).catch(console.error)},xe=8;function ie(r){he(p=>{if(p.includes(r))return p;const d=[...p,r];if(d.length<=xe)return d;const E=d[0];try{je(v=>v.includes(E)?v:[...v,E])}catch{}return d.slice(1)}),Z(r),fe(r).then(p=>{at(d=>({...d,[r]:p}))}).catch(()=>{})}const[ye,De]=i.useState({}),[C,R]=i.useState(!1),se=r=>{R(r),me({showHidden:r}).catch(console.error)},[ue,_e]=i.useState(!1),[Se,$e]=i.useState(!1),[$t,Me]=i.useState(!1),[kt,Ze]=i.useState(!1),[Qe,et]=i.useState(!1),[wl,bl]=i.useState(!1),[Pe,tt]=i.useState(null),[Et,Oe]=i.useState(!0),[nt,Ct]=i.useState(300),[Te,Re]=i.useState("dark"),[Lt,st]=i.useState(0),[jl,Nt]=i.useState(new Date),[Fe,ot]=i.useState(null),[Tt,rt]=i.useState(!1),it=i.useMemo(()=>{const r=new URLSearchParams(window.location.search);return!!r.get("controlled")||!!r.get("theme")},[]);i.useEffect(()=>{const r=p=>{if(p.data){if(p.data.type==="set-theme"){const d=p.data.theme;(d==="light"||d==="dark")&&(Re(d),ke.set("theme",d,Ve),d==="light"?document.documentElement.classList.add("theme-light"):document.documentElement.classList.remove("theme-light"))}if(p.data.type==="screenshot"){const d=document.querySelector(".app"),E=p.data.filename||"mlcremote-screenshot.png";d&&gt(d,E)}}};return window.addEventListener("message",r),()=>window.removeEventListener("message",r)},[]);const[Rt,Sl]=i.useState({}),[It,zt]=i.useState({}),[$l,at]=i.useState({}),Dt=i.useCallback((r,p)=>{zt(d=>({...d,[r]:p}))},[]),Ae=i.useCallback(async()=>{await m()},[m]);i.useEffect(()=>{const r=window.setInterval(()=>Nt(new Date),1e3);return()=>window.clearInterval(r)},[]),i.useEffect(()=>{sn().then(d=>{tt(d),typeof d.allowDelete<"u"&&_e(!!d.allowDelete),typeof d.setupCompleted<"u"?Oe(d.setupCompleted):Oe(!!d.setupCompleted),d.theme&&Re(d.theme),typeof d.autoOpen<"u"&&q(d.autoOpen),typeof d.showHidden<"u"&&R(d.showHidden),typeof d.showLogs<"u"&&$e(d.showLogs),typeof d.hideMemoryUsage<"u"&&et(d.hideMemoryUsage),d.maxEditorSize&&(st(d.maxEditorSize),localStorage.setItem("mlc_max_editor_size",d.maxEditorSize.toString()));const E=new URLSearchParams(window.location.search),v=E.get("theme");(v==="light"||v==="dark")&&(Re(v),v==="light"?document.documentElement.classList.add("theme-light"):document.documentElement.classList.remove("theme-light"));const I=E.get("lng")||E.get("lang");I&&I!==d.language?(console.log(`[i18n] Syncing language from Desktop (${I}) -> Server`),me({language:I}).catch(console.error),n.language!==I&&n.changeLanguage(I)):d.language&&n.language!==d.language&&n.changeLanguage(d.language),rt(!0)}).catch(()=>{tt({allowDelete:!1,defaultShell:"bash"}),rt(!0)});const p=new URLSearchParams(window.location.search).get("profileId");if(p){console.log("Restoring state for profile:",p);try{const d=localStorage.getItem(`workspace_state_${p}`);if(d){const E=JSON.parse(d);E.panes&&_(E.panes),E.layout&&P(E.layout),E.activePaneId&&V(E.activePaneId)}}catch(d){console.error("Failed to restore workspace state",d)}}},[]),i.useEffect(()=>{const p=new URLSearchParams(window.location.search).get("profileId");if(p){const d={panes:M,layout:U,activePaneId:N};localStorage.setItem(`workspace_state_${p}`,JSON.stringify(d))}},[M,U,N]),i.useEffect(()=>{Te==="light"?document.documentElement.classList.add("theme-light"):document.documentElement.classList.remove("theme-light")},[Te]);const lt=r=>{const p=`pane-${Date.now()}`,d=M[N],E=d==null?void 0:d.activeFile;_(v=>({...v,[p]:{id:p,files:E?[E]:[],activeFile:E||null}})),P(v=>{const I=Y=>Y.type==="leaf"?Y.paneId===N?{type:"branch",direction:r,size:50,children:[Y,{type:"leaf",paneId:p}]}:Y:{...Y,children:[I(Y.children[0]),I(Y.children[1])]};return I(v)}),V(p)},Be=r=>{r==="root"&&U.type==="leaf"||(P(p=>{const d=v=>{if(v.type==="leaf")return v.paneId===r?null:v;const I=d(v.children[0]),Y=d(v.children[1]);return!I&&!Y?null:I?Y?{...v,children:[I,Y]}:I:Y};return d(p)||{type:"leaf",paneId:"root"}}),_(p=>{const d={...p};return delete d[r],d}),N===r&&V("root"))},Mt=(r,p)=>{P(d=>{const E=v=>v===r?{...v,size:p}:v.type==="branch"?{...v,children:[E(v.children[0]),E(v.children[1])]}:v;return E(d)})},He=r=>r.type==="leaf"?Pt(r.paneId):e.jsxs(Hn,{direction:r.direction,initialSize:r.size,onResize:p=>Mt(r,p),children:[He(r.children[0]),He(r.children[1])]}),Pt=r=>{const p=M[r];if(!p)return e.jsx("div",{className:"muted",children:"Pane not found"});const d=p.files,E=p.activeFile||"",v=y=>{if(V(r),_(F=>{const B=F[r];return B?(y&&!y.startsWith("shell-")&&y.includes("."),{...F,[r]:{...B,activeFile:y}}):F}),y&&!y.startsWith("shell-")&&y!=="metadata"){const F=y.split("/").filter(Boolean);F.pop(),F.length&&`${F.join("/")}`}y!=="metadata"&&O(y),ae(Date.now())},I=y=>{const F=M[r];if(F){if(F.files.length===1&&F.files[0]===y&&r!=="root"){Be(r);return}_(B=>{const ne=B[r];if(!ne)return B;const le=ne.files.filter(Ot=>Ot!==y);let ve=ne.activeFile;return ne.activeFile===y&&(ve=le[0]||null),{...B,[r]:{...ne,files:le,activeFile:ve}}})}},Y={};for(const y of d)if(y.startsWith("shell-")){const B=(ye[y]||""||"/").split("/").filter(Boolean);let ne="/";if(B.length){const le=B[B.length-1];le.includes(".")&&B.length>1?ne=B[B.length-2]:ne=le}Y[y]=ne}else if(y==="metadata")Y[y]=t("file_details","File Details");else{const F=y.split("/").pop()||y;Y[y]=It[y]?`*${F}`:F}const Ue={},We={};for(const y of d)y.startsWith("shell-")?(Ue[y]="shell",We[y]=ye[y]||"/"):(Ue[y]="file",We[y]=y);const ut=r===N;return e.jsxs("div",{className:"pane-content",style:{height:"100%",display:"flex",flexDirection:"column",position:"relative"},onClick:()=>{ut||V(r)},children:[ut&&e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:2,background:"var(--accent)",zIndex:10}}),d.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{onContextMenu:y=>{y.preventDefault()},children:e.jsx(i.Suspense,{fallback:null,children:e.jsx(Dn,{openFiles:d,active:E,titles:{...Y,metadata:t("details","Details")},fullPaths:{...We,metadata:S||""},types:Ue,onRestoreEvicted:()=>{},onActivate:v,onClose:I,onCloseOthers:y=>{_(F=>{const B=F[r];if(!B)return F;const ne=B.files.filter(le=>le===y);return{...F,[r]:{...B,files:ne,activeFile:y}}})},onCloseLeft:y=>{_(F=>{const B=F[r];if(!B)return F;const ne=B.files.indexOf(y);if(ne<=0)return F;const le=B.files.slice(ne);let ve=B.activeFile;return le.includes(ve||"")||(ve=y),{...F,[r]:{...B,files:le,activeFile:ve}}})}})})}),e.jsx("div",{style:{flex:1,position:"relative"},children:d.map(y=>e.jsx("div",{style:{display:y===E?"block":"none",height:"100%"},children:y.startsWith("shell-")?e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"muted",children:t("loading")}),children:e.jsx(Un,{shell:Pe&&Pe.defaultShell||"bash",path:ye[y]||"",onExit:()=>I(y)},y)}):y==="trash"?e.jsx(un,{}):y==="metadata"?e.jsx(zn,{path:S}):y==="binary"?e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"muted",children:"Loadingâ€¦"}),children:e.jsx(In,{path:u||void 0})}):e.jsx(Rn,{path:y,settings:Pe||void 0,onSaved:()=>{},reloadTrigger:Rt[y]||0,onUnsavedChange:Dt,onMeta:F=>{F&&F.path&&at(B=>({...B,[y]:F}))}})},y))})]}):e.jsxs("div",{className:"welcome-message",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"10px",opacity:.2},children:e.jsx(T,{name:H("folder"),size:48})}),e.jsx("div",{style:{opacity:.5},children:t("no_files")}),r!=="root"&&e.jsxs("button",{className:"btn link",onClick:()=>Be(r),children:[t("close")," Pane"]})]})]})};return Tt?Et?e.jsxs("div",{className:"app",children:[e.jsxs("header",{className:"app-header",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("img",{src:"/logo.png",alt:"MLCRemote logo",style:{height:28,display:"block"},onLoad:()=>g(!0),onError:()=>g(!1)}),!de&&e.jsx("h1",{style:{margin:0},children:"MLCRemote"})]}),e.jsxs("div",{className:"status",children:[e.jsx("button",{className:"link icon-btn",onClick:async()=>{var E;let r=S||"";try{if(r){const v=await fe(r);if(!v.isDir&&v.path){const I=v.path.split("/").filter(Boolean);I.pop(),r=I.length?`/${I.join("/")}`:""}}else if(J&&!J.startsWith("shell-"))try{const v=await fe(J);if(v.isDir)r=v.path||J;else if(v.path){const I=v.path.split("/").filter(Boolean);I.pop(),r=I.length?`/${I.join("/")}`:""}}catch{const I=J.split("/").filter(Boolean);I.pop(),r=I.length?`/${I.join("/")}`:""}}catch{}const p=`shell-${Date.now()}`;let d=r||"";if(d&&((E=d.split("/").pop())!=null&&E.includes("."))){const v=d.split("/").filter(Boolean);v.pop(),d=v.length?`/${v.join("/")}`:"/"}De(v=>({...v,[p]:d})),ie(p)},title:t("terminal"),"aria-label":t("terminal"),children:e.jsx(T,{name:H("terminal"),title:t("terminal"),size:16})}),!it&&e.jsx("button",{className:"link icon-btn","aria-label":"Toggle theme",onClick:()=>{const r=Te==="dark"?"light":"dark";Re(r),ke.set("theme",r,Ve),r==="light"?document.documentElement.classList.add("theme-light"):document.documentElement.classList.remove("theme-light")},children:Te==="dark"?e.jsx(T,{name:H("moon"),title:t("theme"),size:16}):e.jsx(T,{name:H("sun"),title:t("theme"),size:16})}),e.jsx("button",{className:"link icon-btn",title:t("about"),"aria-label":t("about"),onClick:()=>Me(!0),children:e.jsx(T,{name:H("info"),title:t("about"),size:16})}),!it&&e.jsx("button",{className:"link icon-btn",title:"Screenshot","aria-label":"Screenshot",onClick:async()=>{const r=document.querySelector(".app");if(r)try{await gt(r,"mlcremote-screenshot.png")}catch(p){console.error("Screenshot failed",p)}},children:e.jsx(T,{name:H("screenshot"),title:"Screenshot",size:16})}),e.jsx("button",{className:"link icon-btn",title:"Trash","aria-label":"Trash",onClick:()=>{ee.includes("trash")||ie("trash"),Z("trash")},children:e.jsx(T,{name:"icon-trash",title:"Trash",size:16})}),e.jsx("button",{className:"link icon-btn",title:"Split Right","aria-label":"Split Right",onClick:()=>lt("vertical"),children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",style:{display:"block"},children:[e.jsx("path",{fillRule:"evenodd",d:"M14 3H2a1 1 0 00-1 1v8a1 1 0 001 1h12a1 1 0 001-1V4a1 1 0 00-1-1zM2 2a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H2z",clipRule:"evenodd"}),e.jsx("path",{d:"M8 4v8H7V4h1z"})]})}),e.jsx("button",{className:"link icon-btn",title:"Split Down","aria-label":"Split Down",onClick:()=>lt("horizontal"),children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",style:{display:"block"},children:[e.jsx("path",{fillRule:"evenodd",d:"M14 3H2a1 1 0 00-1 1v8a1 1 0 001 1h12a1 1 0 001-1V4a1 1 0 00-1-1zM2 2a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H2z",clipRule:"evenodd"}),e.jsx("path",{d:"M2 8h12v1H2V8z"})]})}),U.type!=="leaf"&&e.jsx("button",{className:"link icon-btn",title:"Close Active Pane","aria-label":"Close Active Pane",onClick:()=>Be(N),style:{marginLeft:4},children:e.jsx(T,{name:H("close"),size:16})}),e.jsx("button",{className:"link icon-btn","aria-label":t("settings"),title:t("settings"),onClick:()=>Ze(r=>!r),children:e.jsx(T,{name:H("settings"),title:t("settings"),size:16})})]}),kt&&e.jsx(dn,{autoOpen:W,showHidden:C,onToggleAutoOpen:r=>te(r),onToggleShowHidden:r=>se(r),showLogs:Se,onToggleLogs:r=>{$e(r),me({showLogs:r}).catch(console.error)},hideMemoryUsage:Qe,onToggleHideMemoryUsage:r=>{et(r),me({hideMemoryUsage:r}).catch(console.error)},onClose:()=>Ze(!1),onLanguageChange:r=>{r!==n.language&&(n.changeLanguage(r),me({language:r}).catch(console.error))},maxEditorSize:Lt,onMaxFileSizeChange:r=>{st(r),me({maxEditorSize:r}).catch(console.error)}})]}),e.jsxs("div",{className:"app-body",style:{alignItems:"stretch"},children:[e.jsx("aside",{className:"sidebar",style:{width:nt},children:e.jsx(cn,{showHidden:C,autoOpen:W,onToggleHidden:r=>se(r),selectedPath:S,activeDir:K,onDirChange:ge,focusRequest:re,reloadSignal:z,onSelect:(r,p)=>{if(O(r),p){ie("metadata");return}(async()=>{try{const d=await fe(r),E=Ge({path:r,meta:d});if(E.name==="Binary"||E.name==="Unsupported"){ee.includes("binary")||ie("binary"),k(r),Z("binary");return}}catch(d){ot({title:"Broken Link",message:`Cannot open file: ${d.message||"stat failed"}`});return}W?ie(r):ee.includes(r)&&Z(r)})(),Ae()},onView:r=>{ee.includes(r)?Z(r):ie(r),r!=="metadata"&&O(r),Ae()},onBackendActive:Ae,onChangeRoot:async()=>{if(!ue){alert("Changing root is not permitted by the server settings");return}const r=window.prompt("Enter the server directory path to use as new root (e.g. /home/user/project):",S||"/");if(!r)return;const p=r.trim();try{if(!(await fe(p)).isDir){alert("Selected path is not a directory");return}O(p);try{ke.set("lastRoot",p,Ve)}catch{}try{const E=ke.getOrDefault("showHidden",xt,!1);ke.set("showHidden",E,xt)}catch{}}catch(d){alert("Cannot access selected path: "+((d==null?void 0:d.message)||d))}}})}),e.jsx("div",{className:"resizer",onMouseDown:r=>{const p=r.clientX,d=nt;function E(I){const Y=I.clientX-p;Ct(Math.max(160,Math.min(800,d+Y)))}function v(){window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",v)}window.addEventListener("mousemove",E),window.addEventListener("mouseup",v)},children:e.jsx("div",{className:"bar"})}),e.jsx("main",{className:"main",children:e.jsxs("div",{className:"main-content",children:[x&&e.jsx("div",{className:"login-overlay",children:e.jsxs("div",{className:"login-box",children:[e.jsx("h3",{children:"Not Authenticated"}),e.jsx("p",{children:"You need to sign in or provide an access key to continue."}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsxs("button",{className:"btn",onClick:()=>{w(!1),j(!0)},children:[t("open")," (password)"]}),e.jsx("button",{className:"btn",onClick:()=>{w(!1),L(!0)},children:"I have an access key"})]})]})}),f&&e.jsx("div",{className:"login-overlay",children:e.jsxs("div",{className:"login-box",children:[e.jsx("h3",{children:"Sign in"}),e.jsx("p",{children:"Please enter the server password to obtain an access token."}),e.jsx("input",{id:"mlc-login-pwd",type:"password",placeholder:"Password"}),e.jsx("div",{style:{marginTop:8},children:e.jsx("button",{className:"btn",onClick:async()=>{const r=document.getElementById("mlc-login-pwd");if(r)try{await c(r.value)}catch(p){alert("Login failed: "+((p==null?void 0:p.message)||p))}},children:t("open")})})]})}),$&&e.jsx("div",{className:"login-overlay",children:e.jsxs("div",{className:"login-box",children:[e.jsx("h3",{children:"Enter Access Token"}),e.jsx("p",{children:"The server requires an access token. Paste it here to continue."}),e.jsx("input",{id:"mlc-token-input",type:"text",placeholder:"token"}),e.jsx("div",{style:{marginTop:8},children:e.jsx("button",{className:"btn",onClick:async()=>{const r=document.getElementById("mlc-token-input");if(r)try{l(r.value.trim())}catch(p){alert("Failed to store token: "+((p==null?void 0:p.message)||p))}},children:"Use token"})})]})}),Fe&&e.jsx(An,{title:Fe.title,message:Fe.message,onClose:()=>ot(null)}),He(U)]})})]}),e.jsx(Bn,{health:s,isOnline:o,hideMemoryUsage:Qe,lastHealthAt:a}),e.jsx(On,{visible:Se,onClose:()=>$e(!1)}),$t&&e.jsx("div",{className:"about-backdrop",onClick:()=>Me(!1),children:e.jsxs("div",{className:"about-modal",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0},children:"MLCRemote"}),e.jsx("button",{"aria-label":t("close"),title:t("close"),onClick:()=>Me(!1),style:{background:"transparent",border:"none",cursor:"pointer"},children:e.jsx(T,{name:"icon-close",size:16})})]}),e.jsxs("div",{style:{marginBottom:8},children:["Copyright Â© ",new Date().getFullYear()," Michael Lechner"]}),e.jsxs("div",{style:{marginBottom:8},children:["Version: ",s?`${s.status}@${s.version}`:"unknown"]}),s&&e.jsxs("div",{style:{maxHeight:"40vh",overflow:"auto",background:"#0b0b0b",color:"white",padding:12,borderRadius:6},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Host:"})," ",s.host]}),e.jsxs("div",{children:[e.jsx("strong",{children:"PID:"})," ",s.pid]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Version:"})," ",s.version]}),e.jsxs("div",{children:[e.jsx("strong",{children:"App Memory:"})," ",ce(s.go_alloc_bytes)," (alloc) / ",ce(s.go_sys_bytes)," (sys)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"System Memory:"})," ",ce((s.sys_mem_total_bytes||0)-(s.sys_mem_free_bytes||0))," / ",ce(s.sys_mem_total_bytes||0)," used"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"CPU:"})," ",Math.round((s.cpu_percent||0)*10)/10,"%"]}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("strong",{children:"Server time:"})," ",s.server_time]}),e.jsxs("div",{style:{marginTop:4},children:[e.jsx("strong",{children:"Timezone:"})," ",s.timezone]}),e.jsxs("div",{className:"muted",style:{marginTop:8,fontSize:12},children:["Last refresh: ",a?new Date(a).toLocaleString():"n/a"]})]})]})})]}):e.jsx(Pn,{onComplete:()=>{Oe(!0),me({setupCompleted:!0}).catch(console.error)}}):null}const Vn="MLCRemote IDE",qn="Files",Yn="Terminal",Gn="Settings",Kn="Search",Xn="New File",Jn="New Folder",Zn="Rename",Qn="Save",es="Cancel",ts="Theme",ns="Screenshot",ss="Language",os="Editor",rs="Run",is="Debug",as="Close",ls="Open",cs="Loading...",ds="No files open",us="Switch to Remote View",hs="Disconnected from server",ms="Refresh",fs="Change Root",ps="Upload",gs="Download",xs="Copy Full Path",ys="Copy Relative Path",_s="Copy Name",vs="Are you sure you want to delete {{path}}?",ws="Auto open files",bs="Show hidden files",js="Show server logs",Ss="Hide memory usage gauge",$s="About MLCRemote",ks="Version",Es="Copyright",Cs="Drop to upload",Ls="View file",Ns="Loading trash...",Ts="Trash is empty",Rs="Original path",Is="Trash path",zs="Undo (coming)",Ds="Connected to shell session: {{id}}",Ms="Connected to ephemeral shell",Ps="Copy",Os="Paste",Fs="Paste text here",As="Logs",Bs="Clear",Hs="Loading PDF support...",Us="Loading PDF...",Ws="Prev",Vs="Next",qs="No preview",Ys="No file selected",Gs="Full path",Ks="MIME",Xs="Size",Js="Mode",Zs="Last Modified",Qs="Is Dir",eo="Yes",to="No",no="Loading metadata...",so="Open or create a file to edit",oo="Close Others",ro="Close Left",io="Restore",ao="scroll left",lo="scroll right",co="Editor Settings",uo="Properties",ho="Max File Size (MB)",mo="Files larger than this will open in read-only mode.",fo={app_title:Vn,files:qn,terminal:Yn,settings:Gn,search:Kn,new_file:Xn,new_folder:Jn,rename:Zn,delete:"Delete",save:Qn,cancel:es,theme:ts,screenshot:ns,language:ss,editor:os,run:rs,debug:is,close:as,open:ls,loading:cs,no_files:ds,switch_to_remote:us,disconnected:hs,refresh:ms,change_root:fs,upload:ps,download:gs,copy_full_path:xs,copy_relative_path:ys,copy_name:_s,delete_confirm:vs,auto_open_files:ws,show_hidden_files:bs,show_server_logs:js,hide_memory_usage:Ss,about:$s,version:ks,copyright:Es,drop_to_upload:Cs,view_file:Ls,loading_trash:Ns,trash_empty:Ts,original_path:Rs,trash_path:Is,undo_coming:zs,terminal_connected_session:Ds,terminal_connected_ephemeral:Ms,copy:Ps,paste:Os,paste_text_here:Fs,logs:As,clear:Bs,loading_pdf_support:Hs,loading_pdf:Us,previous:Ws,next:Vs,no_preview:qs,no_file_selected:Ys,full_path:Gs,mime:Ks,size:Xs,mode:Js,last_modified:Zs,is_dir:Qs,yes:eo,no:to,loading_metadata:no,open_or_create_file:so,close_others:oo,close_left:ro,restore:io,scroll_left:ao,scroll_right:lo,editor_settings:co,properties:uo,max_file_size:ho,max_file_size_tooltip:mo},po="MLCRemote IDE",go="Dateien",xo="Terminal",yo="Einstellungen",_o="Suchen",vo="Neue Datei",wo="Neuer Ordner",bo="Umbenennen",jo="Speichern",So="Abbrechen",$o="Design",ko="Sprache",Eo="Editor",Co="AusfÃ¼hren",Lo="Debuggen",No="SchlieÃŸen",To="Ã–ffnen",Ro="Laden...",Io="Keine Dateien geÃ¶ffnet",zo="Zur Remote-Ansicht wechseln",Do="Vom Server getrennt",Mo="Aktualisieren",Po="Wurzelverzeichnis Ã¤ndern",Oo="Hochladen",Fo="Herunterladen",Ao="VollstÃ¤ndigen Pfad kopieren",Bo="Relativen Pfad kopieren",Ho="Namen kopieren",Uo="Sind Sie sicher, dass Sie {{path}} lÃ¶schen mÃ¶chten?",Wo="Dateien automatisch Ã¶ffnen",Vo="Versteckte Dateien anzeigen",qo="Server-Logs anzeigen",Yo="Speicherauslastung ausblenden",Go="Ãœber MLCRemote",Ko="Version",Xo="Urheberrecht",Jo="Zum Hochladen hier ablegen",Zo="Datei anzeigen",Qo="Papierkorb wird geladen...",er="Papierkorb ist leer",tr="UrsprÃ¼nglicher Pfad",nr="Papierkorb-Pfad",sr="RÃ¼ckgÃ¤ngig (demnÃ¤chst)",or="Verbunden mit Shell-Sitzung: {{id}}",rr="Verbunden mit temporÃ¤rer Shell",ir="Kopieren",ar="EinfÃ¼gen",lr="Text hier einfÃ¼gen",cr="Protokolle",dr="LÃ¶schen",ur="PDF-UnterstÃ¼tzung wird geladen...",hr="PDF wird geladen...",mr="ZurÃ¼ck",fr="Weiter",pr="Keine Vorschau",gr="Keine Datei ausgewÃ¤hlt",xr="VollstÃ¤ndiger Pfad",yr="MIME-Typ",_r="GrÃ¶ÃŸe",vr="Modus",wr="Zuletzt geÃ¤ndert",br="Ist Verzeichnis",jr="Ja",Sr="Nein",$r="Metadaten werden geladen...",kr="Ã–ffnen oder erstellen Sie eine Datei zum Bearbeiten",Er="Andere schlieÃŸen",Cr="Links schlieÃŸen",Lr="Wiederherstellen",Nr="nach links scrollen",Tr="nach rechts scrollen",Rr="Editor-Einstellungen",Ir="Eigenschaften",zr="Max. DateigrÃ¶ÃŸe (MB)",Dr="Dateien, die grÃ¶ÃŸer sind, werden schreibgeschÃ¼tzt geÃ¶ffnet.",Mr={app_title:po,files:go,terminal:xo,settings:yo,search:_o,new_file:vo,new_folder:wo,rename:bo,delete:"LÃ¶schen",save:jo,cancel:So,theme:$o,language:ko,editor:Eo,run:Co,debug:Lo,close:No,open:To,loading:Ro,no_files:Io,switch_to_remote:zo,disconnected:Do,refresh:Mo,change_root:Po,upload:Oo,download:Fo,copy_full_path:Ao,copy_relative_path:Bo,copy_name:Ho,delete_confirm:Uo,auto_open_files:Wo,show_hidden_files:Vo,show_server_logs:qo,hide_memory_usage:Yo,about:Go,version:Ko,copyright:Xo,drop_to_upload:Jo,view_file:Zo,loading_trash:Qo,trash_empty:er,original_path:tr,trash_path:nr,undo_coming:sr,terminal_connected_session:or,terminal_connected_ephemeral:rr,copy:ir,paste:ar,paste_text_here:lr,logs:cr,clear:dr,loading_pdf_support:ur,loading_pdf:hr,previous:mr,next:fr,no_preview:pr,no_file_selected:gr,full_path:xr,mime:yr,size:_r,mode:vr,last_modified:wr,is_dir:br,yes:jr,no:Sr,loading_metadata:$r,open_or_create_file:kr,close_others:Er,close_left:Cr,restore:Lr,scroll_left:Nr,scroll_right:Tr,editor_settings:Rr,properties:Ir,max_file_size:zr,max_file_size_tooltip:Dr},Pr="MLCRemote IDE",Or="Archivos",Fr="Terminal",Ar="ConfiguraciÃ³n",Br="Buscar",Hr="Nuevo Archivo",Ur="Nueva Carpeta",Wr="Renombrar",Vr="Guardar",qr="Cancelar",Yr="Tema",Gr="Idioma",Kr="Editor",Xr="Ejecutar",Jr="Depurar",Zr="Cerrar",Qr="Abrir",ei="Cargando...",ti="No hay archivos abiertos",ni="Cambiar a vista remota",si="Desconectado del servidor",oi="Actualizar",ri="Cambiar raÃ­z",ii="Subir",ai="Descargar",li="Copiar ruta completa",ci="Copiar ruta relativa",di="Copiar nombre",ui="Â¿EstÃ¡s seguro de que deseas eliminar {{path}}?",hi="Abrir archivos automÃ¡ticamente",mi="Mostrar archivos ocultos",fi="Mostrar logs del servidor",pi="Ocultar uso de memoria",gi="Acerca de MLCRemote",xi="VersiÃ³n",yi="Derechos de autor",_i="Soltar para subir",vi="Ver archivo",wi="Cargando papelera...",bi="La papelera estÃ¡ vacÃ­a",ji="Ruta original",Si="Ruta de la papelera",$i="Deshacer (prÃ³ximamente)",ki="Conectado a la sesiÃ³n de shell: {{id}}",Ei="Conectado a la shell efÃ­mera",Ci="Copiar",Li="Pegar",Ni="Pegar texto aquÃ­",Ti="Registros",Ri="Limpiar",Ii="Cargando soporte PDF...",zi="Cargando PDF...",Di="Ant",Mi="Sig",Pi="Sin vista previa",Oi="NingÃºn archivo seleccionado",Fi="Ruta completa",Ai="MIME",Bi="TamaÃ±o",Hi="Modo",Ui="Ãšltima modificaciÃ³n",Wi="Es directorio",Vi="SÃ­",qi="No",Yi="Cargando metadatos...",Gi="Abrir o crear un archivo para editar",Ki="Cerrar otros",Xi="Cerrar izquierda",Ji="Restaurar",Zi="desplazarse a la izquierda",Qi="desplazarse a la derecha",ea="Propiedades",ta={app_title:Pr,files:Or,terminal:Fr,settings:Ar,search:Br,new_file:Hr,new_folder:Ur,rename:Wr,delete:"Eliminar",save:Vr,cancel:qr,theme:Yr,language:Gr,editor:Kr,run:Xr,debug:Jr,close:Zr,open:Qr,loading:ei,no_files:ti,switch_to_remote:ni,disconnected:si,refresh:oi,change_root:ri,upload:ii,download:ai,copy_full_path:li,copy_relative_path:ci,copy_name:di,delete_confirm:ui,auto_open_files:hi,show_hidden_files:mi,show_server_logs:fi,hide_memory_usage:pi,about:gi,version:xi,copyright:yi,drop_to_upload:_i,view_file:vi,loading_trash:wi,trash_empty:bi,original_path:ji,trash_path:Si,undo_coming:$i,terminal_connected_session:ki,terminal_connected_ephemeral:Ei,copy:Ci,paste:Li,paste_text_here:Ni,logs:Ti,clear:Ri,loading_pdf_support:Ii,loading_pdf:zi,previous:Di,next:Mi,no_preview:Pi,no_file_selected:Oi,full_path:Fi,mime:Ai,size:Bi,mode:Hi,last_modified:Ui,is_dir:Wi,yes:Vi,no:qi,loading_metadata:Yi,open_or_create_file:Gi,close_others:Ki,close_left:Xi,restore:Ji,scroll_left:Zi,scroll_right:Qi,properties:ea},na="MLCRemote IDE",sa="Fichiers",oa="Terminal",ra="ParamÃ¨tres",ia="Rechercher",aa="Nouveau Fichier",la="Nouveau Dossier",ca="Renommer",da="Enregistrer",ua="Annuler",ha="ThÃ¨me",ma="Langue",fa="Ã‰diteur",pa="ExÃ©cuter",ga="DÃ©boguer",xa="Fermer",ya="Ouvrir",_a="Chargement...",va="Aucun fichier ouvert",wa="Passer Ã  la vue distante",ba="DÃ©connectÃ© du serveur",ja="Actualiser",Sa="Changer la racine",$a="TÃ©lÃ©verser",ka="TÃ©lÃ©charger",Ea="Copier le chemin complet",Ca="Copiar le chemin relatif",La="Copier le nom",Na="ÃŠtes-vous sÃ»r de vouloir supprimer {{path}} ?",Ta="Ouvrir les fichiers automatiquement",Ra="Afficher les fichiers cachÃ©s",Ia="Afficher les logs du serveur",za="Masquer l'utilisation de la mÃ©moire",Da="Ã€ propos de MLCRemote",Ma="Version",Pa="Copyright",Oa="DÃ©poser pour tÃ©lÃ©verser",Fa="Voir le fichier",Aa="Chargement de la corbeille...",Ba="La corbeille est vide",Ha="Chemin d'origine",Ua="Chemin de la corbeille",Wa="Annuler (prochainement)",Va="ConnectÃ© Ã  la session shell : {{id}}",qa="ConnectÃ© au shell Ã©phÃ©mÃ¨re",Ya="Copier",Ga="Coller",Ka="Coller le texte ici",Xa="Journaux",Ja="Effacer",Za="Chargement du support PDF...",Qa="Chargement du PDF...",el="PrÃ©c",tl="Suiv",nl="Pas d'aperÃ§u",sl="Aucun fichier sÃ©lectionnÃ©",ol="Chemin complet",rl="MIME",il="Taille",al="Mode",ll="DerniÃ¨re modification",cl="Est un rÃ©pertoire",dl="Oui",ul="Non",hl="Chargement des mÃ©tadatos...",ml="Ouvrir ou crÃ©er un fichier Ã  Ã©diter",fl="Fermer les autres",pl="Fermer Ã  gauche",gl="Restaurer",xl="faire dÃ©filer vers la gauche",yl="faire dÃ©filer vers la droite",_l="PropriÃ©tÃ©s",vl={app_title:na,files:sa,terminal:oa,settings:ra,search:ia,new_file:aa,new_folder:la,rename:ca,delete:"Supprimer",save:da,cancel:ua,theme:ha,language:ma,editor:fa,run:pa,debug:ga,close:xa,open:ya,loading:_a,no_files:va,switch_to_remote:wa,disconnected:ba,refresh:ja,change_root:Sa,upload:$a,download:ka,copy_full_path:Ea,copy_relative_path:Ca,copy_name:La,delete_confirm:Na,auto_open_files:Ta,show_hidden_files:Ra,show_server_logs:Ia,hide_memory_usage:za,about:Da,version:Ma,copyright:Pa,drop_to_upload:Oa,view_file:Fa,loading_trash:Aa,trash_empty:Ba,original_path:Ha,trash_path:Ua,undo_coming:Wa,terminal_connected_session:Va,terminal_connected_ephemeral:qa,copy:Ya,paste:Ga,paste_text_here:Ka,logs:Xa,clear:Ja,loading_pdf_support:Za,loading_pdf:Qa,previous:el,next:tl,no_preview:nl,no_file_selected:sl,full_path:ol,mime:rl,size:il,mode:al,last_modified:ll,is_dir:cl,yes:dl,no:ul,loading_metadata:hl,open_or_create_file:ml,close_others:fl,close_left:pl,restore:gl,scroll_left:xl,scroll_right:yl,properties:_l};yt.use(Wt).use(Bt).init({resources:{en:{translation:fo},de:{translation:Mr},es:{translation:ta},fr:{translation:vl}},fallbackLng:"en",interpolation:{escapeValue:!1}});console.log("MLCRemote: captureTokenFromURL type:",typeof Ye);try{const n=new URLSearchParams(window.location.search).get("api");if(n)try{const o=new URL(n).searchParams.get("lang");o&&(console.log("MLCRemote: Setting language to",o),yt.changeLanguage(o))}catch(s){console.error("Failed to parse api url for lang",s)}typeof Ye=="function"?Ye():console.error("MLCRemote: captureTokenFromURL is not a function!")}catch(t){console.error("MLCRemote: Initialization error",t)}window.addEventListener("dragover",t=>t.preventDefault());window.addEventListener("drop",t=>t.preventDefault());(async()=>{try{const t=await Ie(()=>import("./icons-sprite-C05SJ8iO.js"),[],import.meta.url),n=t&&(t.default||t);if(n&&typeof document<"u"){const s=document.createElement("div");s.style.width="0",s.style.height="0",s.style.position="absolute",s.style.visibility="hidden",s.innerHTML=n,document.body.insertBefore(s,document.body.firstChild)}}catch(t){alert("Failed to load icon sprite: "+((t==null?void 0:t.message)||t))}})();Ht(document.getElementById("root")).render(e.jsx(on,{children:e.jsx(Wn,{})}));export{Ie as _,oe as a,zl as g,be as m,fe as s};
